<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-translate="page_title">Van Hool Parts Catalog - Rare Bus Parts & Components</title>
    <meta name="description" data-translate="meta_description" content="Browse our complete catalog of Van Hool bus parts. Find brake systems, air pressure components, suspension parts and more.">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="css/custom-colors.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-lg border-b sticky top-0 z-50">
        <div class="container mx-auto px-4 lg:px-8">
            <nav class="flex items-center justify-between h-16 lg:h-20">
                <!-- Left: Logo -->
                <div class="flex items-center">
                    <a href="index.html" class="text-xl lg:text-2xl font-bold text-red-600 flex items-center hover:text-red-700 transition-colors">
                        <img src="LOGO1 1.svg" alt="Van Hool Parts" class="h-8 lg:h-10 w-auto">
                        <span class="sm:hidden">VHP</span>
                    </a>
                </div>
                    
                <!-- Center: Navigation -->
                <div class="flex-1 flex justify-center">
                    <!-- Desktop Navigation -->
                    <div class="hidden lg:flex items-center space-x-8">
                        <!-- Categories Dropdown -->
                        <div class="relative" onmouseenter="showDropdown()" onmouseleave="hideDropdown()">
                            <button class="flex items-center space-x-1 text-gray-600 hover:text-red-600 py-2 font-medium transition-colors">
                                <i class="fas fa-th-large mr-1"></i>
                                <span data-translate="categories">Categories</span>
                                <i class="fas fa-chevron-down text-sm ml-1 group-hover:rotate-180 transition-transform duration-200"></i>
                            </button>
                            <!-- Enhanced Categories Dropdown -->
                            <div id="categories-dropdown-menu" class="absolute overflow-x-hidden  top-full left-0 bg-white shadow-xl border rounded-lg z-50 w-96  px-6  max-h-100 overflow-y-hidden" style="display: none;">
                                <!-- Categories Content -->
                                <div id="categories-dropdown">
                                    <div class="py-4">
                                        <h4 class="font-semibold mb-4 text-center">Van Hool Parts Categories</h4>
                                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 lg:gap-4">
                                            
                                            <!-- Brake System -->
                                            <div class="relative group/category">
                                                <a href="?category=brake-system" class="flex items-center p-3 rounded-lg hover:bg-red-50 border transition-colors">
                                                    <div class="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center mr-3">
                                                        <i class="fas fa-stop-circle text-red-600"></i>
                                                    </div>
                                                    <div class="flex-1">
                                                        <div class="font-medium">Brake System</div>
                                                        <div class="text-sm text-gray-500">Pads, Discs, Fluid</div>
                                                    </div>
                                                    <i class="fas fa-chevron-right text-gray-400 group-hover/category:text-red-600"></i>
                                                </a>
                                                <!-- Subcategories -->
                                                <div class="absolute left-full top-0 ml-2 w-64 bg-white border rounded-lg shadow-lg opacity-0 invisible group-hover/category:opacity-100 group-hover/category:visible transition-all duration-200 z-60">
                                                    <div class="p-3">
                                                        <div class="text-sm font-medium text-gray-900 mb-2">Brake Components</div>
                                                        <a href="?category=brake-pads" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md transition-colors">Brake Pads</a>
                                                        <a href="?category=brake-discs" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md transition-colors">Brake Discs</a>
                                                        <a href="?category=brake-fluid" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md transition-colors">Brake Fluid</a>
                                                        <a href="?category=brake-calipers" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md transition-colors">Brake Calipers</a>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Air Pressure System -->
                                            <div class="relative group/category">
                                                <a href="?category=air-pressure" class="flex items-center p-3 rounded-lg hover:bg-red-50 border transition-colors">
                                                    <div class="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center mr-3">
                                                        <i class="fas fa-wind text-red-600"></i>
                                                    </div>
                                                    <div class="flex-1">
                                                        <div class="font-medium">Air Pressure</div>
                                                        <div class="text-sm text-gray-500">Compressors, Valves</div>
                                                    </div>
                                                    <i class="fas fa-chevron-right text-gray-400 group-hover/category:text-red-600"></i>
                                                </a>
                                                <!-- Subcategories -->
                                                <div class="absolute left-full top-0 ml-2 w-64 bg-white border rounded-lg shadow-lg opacity-0 invisible group-hover/category:opacity-100 group-hover/category:visible transition-all duration-200 z-60">
                                                    <div class="p-3">
                                                        <div class="text-sm font-medium text-gray-900 mb-2">Air System Parts</div>
                                                        <a href="?category=air-compressors" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md transition-colors">Air Compressors</a>
                                                        <a href="?category=air-valves" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md transition-colors">Air Valves</a>
                                                        <a href="?category=air-tanks" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md transition-colors">Air Tanks</a>
                                                        <a href="?category=air-filters" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md transition-colors">Air Filters</a>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Electrical System -->
                                            <div class="relative group/category">
                                                <a href="?category=electrical" class="flex items-center p-3 rounded-lg hover:bg-red-50 border transition-colors">
                                                    <div class="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center mr-3">
                                                        <i class="fas fa-bolt text-red-600"></i>
                                                    </div>
                                                    <div class="flex-1">
                                                        <div class="font-medium">Electrical</div>
                                                        <div class="text-sm text-gray-500">Lighting, Wiring</div>
                                                    </div>
                                                    <i class="fas fa-chevron-right text-gray-400 group-hover/category:text-red-600"></i>
                                                </a>
                                                <!-- Subcategories -->
                                                <div class="absolute left-full top-0 ml-2 w-64 bg-white border rounded-lg shadow-lg opacity-0 invisible group-hover/category:opacity-100 group-hover/category:visible transition-all duration-200 z-60">
                                                    <div class="p-3">
                                                        <div class="text-sm font-medium text-gray-900 mb-2">Electrical Parts</div>
                                                        <a href="?category=headlights" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md transition-colors">Headlights</a>
                                                        <a href="?category=tail-lights" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md transition-colors">Tail Lights</a>
                                                        <a href="?category=wiring-harness" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md transition-colors">Wiring Harness</a>
                                                        <a href="?category=switches" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md transition-colors">Switches</a>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Chassis & Suspension -->
                                            <div class="relative group/category">
                                                <a href="?category=chassis-suspension" class="flex items-center p-3 rounded-lg hover:bg-red-50 border transition-colors">
                                                    <div class="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center mr-3">
                                                        <i class="fas fa-car-side text-red-600"></i>
                                                    </div>
                                                    <div class="flex-1">
                                                        <div class="font-medium">Chassis & Suspension</div>
                                                        <div class="text-sm text-gray-500">Suspension, Frames</div>
                                                    </div>
                                                    <i class="fas fa-chevron-right text-gray-400 group-hover/category:text-red-600"></i>
                                                </a>
                                                <!-- Subcategories -->
                                                <div class="absolute left-full top-0 ml-2 w-64 bg-white border rounded-lg shadow-lg opacity-0 invisible group-hover/category:opacity-100 group-hover/category:visible transition-all duration-200 z-60">
                                                    <div class="p-3">
                                                        <div class="text-sm font-medium text-gray-900 mb-2">Chassis Parts</div>
                                                        <a href="?category=suspension-parts" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md transition-colors">Suspension Parts</a>
                                                        <a href="?category=chassis-parts" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md transition-colors">Chassis Parts</a>
                                                        <a href="?category=shock-absorbers" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md transition-colors">Shock Absorbers</a>
                                                        <a href="?category=springs" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md transition-colors">Springs</a>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Engine & Transmission -->
                                            <div class="relative group/category">
                                                <a href="?category=engine-transmission" class="flex items-center p-3 rounded-lg hover:bg-red-50 border transition-colors">
                                                    <div class="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center mr-3">
                                                        <i class="fas fa-cog text-red-600"></i>
                                                    </div>
                                                    <div class="flex-1">
                                                        <div class="font-medium">Engine & Transmission</div>
                                                        <div class="text-sm text-gray-500">Engine Parts, Gears</div>
                                                    </div>
                                                    <i class="fas fa-chevron-right text-gray-400 group-hover/category:text-red-600"></i>
                                                </a>
                                                <!-- Subcategories -->
                                                <div class="absolute left-full top-0 ml-2 w-64 bg-white border rounded-lg shadow-lg opacity-0 invisible group-hover/category:opacity-100 group-hover/category:visible transition-all duration-200 z-60">
                                                    <div class="p-3">
                                                        <div class="text-sm font-medium text-gray-900 mb-2">Engine Parts</div>
                                                        <a href="?category=engine-filters" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md transition-colors">Engine Filters</a>
                                                        <a href="?category=transmission-parts" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md transition-colors">Transmission Parts</a>
                                                        <a href="?category=cooling-system" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md transition-colors">Cooling System</a>
                                                        <a href="?category=exhaust-system" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md transition-colors">Exhaust System</a>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Body & Interior -->
                                            <div class="relative group/category">
                                                <a href="?category=body-interior" class="flex items-center p-3 rounded-lg hover:bg-red-50 border transition-colors">
                                                    <div class="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center mr-3">
                                                        <i class="fas fa-door-open text-red-600"></i>
                                                    </div>
                                                    <div class="flex-1">
                                                        <div class="font-medium">Body & Interior</div>
                                                        <div class="text-sm text-gray-500">Doors, Seats, Panels</div>
                                                    </div>
                                                    <i class="fas fa-chevron-right text-gray-400 group-hover/category:text-red-600"></i>
                                                </a>
                                                <!-- Subcategories -->
                                                <div class="absolute left-full top-0 ml-2 w-64 bg-white border rounded-lg shadow-lg opacity-0 invisible group-hover/category:opacity-100 group-hover/category:visible transition-all duration-200 z-60">
                                                    <div class="p-3">
                                                        <div class="text-sm font-medium text-gray-900 mb-2">Body Parts</div>
                                                        <a href="?category=doors" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md transition-colors">Doors</a>
                                                        <a href="?category=seats" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md transition-colors">Seats</a>
                                                        <a href="?category=body-panels" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md transition-colors">Body Panels</a>
                                                        <a href="?category=mirrors" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md transition-colors">Mirrors</a>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Footer -->
                                <div class="border-t bg-gray-50 p-4 rounded-b-xl">
                                    <div class="flex items-center justify-between">
                                        <div class="text-sm text-gray-600">
                                            <span data-translate="over_parts">Over 1000+ authentic parts</span>
                                        </div>
                                        <a href="catalog.html" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors font-medium text-sm">
                                            <span data-translate="view_all_catalog">View All Catalog</span>
                                            <i class="fas fa-arrow-right ml-2"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Regular Navigation Links -->
                        <a href="catalog.html" class="text-gray-600 hover:text-red-600 font-medium transition-colors px-3 py-2 rounded-lg hover:bg-red-50" data-translate="catalog">Catalog</a>
                        <a href="#about" class="text-gray-600 hover:text-red-600 font-medium transition-colors px-3 py-2 rounded-lg hover:bg-red-50" data-translate="about">About</a>
                        <a href="#contact" class="text-gray-600 hover:text-red-600 font-medium transition-colors px-3 py-2 rounded-lg hover:bg-red-50" data-translate="contact">Contact</a>
                    </div>

                    <!-- Tablet Navigation -->
                    <div class="hidden md:flex lg:hidden items-center space-x-4">
                        <a href="catalog.html" class="text-gray-600 hover:text-red-600 font-medium transition-colors" data-translate="catalog">Catalog</a>
                        <div class="relative group">
                            <button class="flex items-center space-x-1 text-gray-600 hover:text-red-600 py-2 font-medium transition-colors">
                                <i class="fas fa-th-large"></i>
                                <i class="fas fa-chevron-down text-sm"></i>
                            </button>
                            <div class="absolute top-full right-0 bg-white shadow-lg border rounded-lg hidden group-hover:block z-50 w-48">
                                <div class="p-3">
                                    <a href="?category=brake-system" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md">Brake System</a>
                                    <a href="?category=electrical" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md">Electrical</a>
                                    <a href="?category=engine" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md">Engine</a>
                                    <a href="catalog.html" class="block px-3 py-2 text-sm text-red-600 font-medium border-t mt-2 pt-2">View All ‚Üí</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Right: User Actions -->
                <div class="flex items-center">
                    <!-- Right Side Navigation -->
                <div class="flex items-center space-x-2 lg:space-x-4">
                    <!-- Mobile menu button -->
                    <button id="mobile-menu-button" class="lg:hidden flex items-center px-3 py-2 rounded-lg text-gray-600 hover:text-red-600 hover:bg-red-50 transition-all duration-200">
                        <i class="fas fa-bars text-lg"></i>
                    </button>
                    
                    <!-- Language Switcher -->
                    <div class="relative group hidden sm:block">
                        <button class="flex items-center space-x-1 text-gray-700 hover:text-red-600 py-2 px-2 lg:px-3 rounded-md transition-colors">
                            <span id="current-lang" class="text-sm font-medium">EN</span>
                            <i class="fas fa-chevron-down text-xs"></i>
                        </button>
                        <div class="absolute top-full right-0 bg-white shadow-lg border rounded-lg hidden group-hover:block z-50 min-w-max">
                            <button onclick="setLanguage('en')" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 w-full text-left">üá¨üáß English</button>
                            <button onclick="setLanguage('ro')" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 w-full text-left">üá∑üá¥ Rom√¢nƒÉ</button>
                            <button onclick="setLanguage('ru')" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 w-full text-left">üá∑üá∫ –†—É—Å—Å–∫–∏–π</button>
                        </div>
                    </div>
                    
                    <!-- Cart Icon -->
                    <div class="relative">
                        <button id="cart-toggle" class="flex items-center space-x-1 text-gray-600 hover:text-red-600 py-2 px-2 lg:px-3 rounded-md transition-all duration-200 relative">
                            <i class="fas fa-shopping-cart text-lg"></i>
                            <span id="cart-count" class="bg-red-600 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center absolute -top-1 -right-1 min-w-[20px]">0</span>
                        </button>
                    </div>
                    
                    <!-- Auth Links -->
                    <div id="auth-links" class="hidden md:flex items-center space-x-3">
                        <a href="login.html" class="text-gray-600 hover:text-red-600 font-medium transition-colors" data-translate="login">Login</a>
                        <a href="register.html" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-all duration-200 font-medium shadow-sm hover:shadow-md" data-translate="register">Register</a>
                    </div>
                </div>
                </div>
            </nav>
            
            <!-- Mobile menu -->
            <div id="mobile-menu" class="lg:hidden hidden bg-white border-t shadow-lg">
                <div class="px-4 py-4 space-y-2">
                    <!-- Mobile Categories -->
                    <div class="mb-4">
                        <h3 class="text-sm font-semibold text-gray-900 mb-3 px-2">Categories</h3>
                        <div class="space-y-1">
                            <a href="?category=brake-system" class="flex items-center px-3 py-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors">
                                <i class="fas fa-stop-circle mr-3 w-4"></i>Brake System
                            </a>
                            <a href="?category=electrical" class="flex items-center px-3 py-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors">
                                <i class="fas fa-bolt mr-3 w-4"></i>Electrical
                            </a>
                            <a href="?category=engine" class="flex items-center px-3 py-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors">
                                <i class="fas fa-cog mr-3 w-4"></i>Engine
                            </a>
                        </div>
                    </div>
                    
                    <div class="border-t pt-3 space-y-1">
                        <a href="catalog.html" class="block px-3 py-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors font-medium" data-translate="catalog">
                            <i class="fas fa-th-grid mr-2"></i>Catalog
                        </a>
                        <a href="#about" class="block px-3 py-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors" data-translate="about">
                            <i class="fas fa-info-circle mr-2"></i>About
                        </a>
                        <a href="#contact" class="block px-3 py-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors" data-translate="contact">
                            <i class="fas fa-envelope mr-2"></i>Contact
                        </a>
                    </div>
                    
                    
                    <!-- Mobile Language -->
                    <div class="border-t pt-3">
                        <div class="flex justify-center space-x-4">
                            <button onclick="setLanguage('en')" class="px-3 py-1 text-sm text-gray-600 hover:text-red-600 transition-colors">üá¨üáß EN</button>
                            <button onclick="setLanguage('ro')" class="px-3 py-1 text-sm text-gray-600 hover:text-red-600 transition-colors">üá∑üá¥ RO</button>
                            <button onclick="setLanguage('ru')" class="px-3 py-1 text-sm text-gray-600 hover:text-red-600 transition-colors">üá∑üá∫ RU</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="bg-gradient-to-r from-blue-600 to-blue-800 text-white py-16">
        <div class="container mx-auto px-4 text-center">
            <h1 class="text-4xl font-bold mb-4" data-translate="title">Van Hool Parts Catalog</h1>
            <p class="text-xl text-blue-100" data-translate="subtitle">Find the perfect part for your Van Hool bus</p>
        </div>
    </section>

    <!-- Main Content -->
    <div class="container mx-auto px-4 py-8">
        <div class="flex flex-col lg:flex-row gap-8">
            <!-- Filters Sidebar -->
            <div class="lg:w-1/4">
                <div class="bg-white rounded-lg shadow-sm p-6 sticky top-24">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4" data-translate="filters">Filters</h3>
                    
                    <!-- Search -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2" data-translate="search">Search</label>
                        <input type="text" id="search-input" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"
                               data-translate-placeholder="search_placeholder">
                    </div>
                    
                    <!-- Category -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2" data-translate="category">Category</label>
                        <select id="category-filter" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent">
                            <option value="" data-translate="all_categories">All Categories</option>
                        </select>
                    </div>
                    
                    <!-- Price Range -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2" data-translate="price_range">Price Range</label>
                        <div class="flex space-x-2">
                            <input type="number" id="min-price" placeholder="Min" class="w-1/2 px-3 py-2 border border-gray-300 rounded-lg">
                            <input type="number" id="max-price" placeholder="Max" class="w-1/2 px-3 py-2 border border-gray-300 rounded-lg">
                        </div>
                    </div>
                    
                    <!-- Availability -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2" data-translate="availability">Availability</label>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="checkbox" id="in-stock-filter" class="rounded border-gray-300 text-red-600 focus:ring-red-500">
                                <span class="ml-2 text-sm text-gray-700" data-translate="in_stock">In Stock</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="featured-filter" class="rounded border-gray-300 text-red-600 focus:ring-red-500">
                                <span class="ml-2 text-sm text-gray-700" data-translate="featured">Featured</span>
                            </label>
                        </div>
                    </div>
                    
                    <button id="clear-filters" class="w-full px-4 py-2 text-sm text-red-600 border border-red-600 rounded-lg hover:bg-red-50" data-translate="clear_filters">Clear Filters</button>
                </div>
            </div>
            
            <!-- Products Grid -->
            <div class="lg:w-3/4">
                <!-- Sort and Results -->
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4">
                    <div id="results-count" class="text-gray-600"></div>
                    <div class="flex items-center space-x-2">
                        <label class="text-sm text-gray-700" data-translate="sort_by">Sort by:</label>
                        <select id="sort-select" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent">
                            <option value="name" data-translate="sort_name">Name</option>
                            <option value="price_asc" data-translate="sort_price_low">Price: Low to High</option>
                            <option value="price_desc" data-translate="sort_price_high">Price: High to Low</option>
                            <option value="featured" data-translate="sort_featured">Featured</option>
                        </select>
                    </div>
                </div>
                
                <!-- Loading State -->
                <div id="loading-products" class="text-center py-12">
                    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto mb-4"></div>
                    <p class="text-gray-600" data-translate="loading">Loading products...</p>
                </div>
                
                <!-- Products Grid -->
                <div id="products-grid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 mb-8">
                    <!-- Products will be loaded here -->
                </div>
                
                <!-- No Results -->
                <div id="no-results" class="hidden text-center py-12">
                    <i class="fas fa-search text-gray-400 text-4xl mb-4"></i>
                    <h3 class="text-lg font-semibold text-gray-900 mb-2" data-translate="no_results">No products found</h3>
                    <p class="text-gray-600" data-translate="no_results_desc">Try adjusting your filters or search terms</p>
                </div>
                
                <!-- Pagination -->
                <div id="pagination" class="hidden flex justify-center items-center space-x-4">
                    <button id="prev-page" class="px-4 py-2 text-sm text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <div id="page-info" class="text-sm text-gray-600"></div>
                    <button id="next-page" class="px-4 py-2 text-sm text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Universal App System -->
    <script src="js/app-universal.js"></script>
    <script src="js/categories-dropdown.js"></script>
    
    <script>
        console.log('üî• Catalog page loaded');
        
        // Dropdown functions
        function showDropdown() {
            document.getElementById('categories-dropdown-menu').style.display = 'block';
        }
        
        function hideDropdown() {
            document.getElementById('categories-dropdown-menu').style.display = 'none';
        }
        
        // Load categories for dropdown
        async function loadCategoriesDropdown() {
            try {
                const { data: allCategories, error } = await window.supabase
                    .from('categories')
                    .select('*')
                    .order('sort_order');
                
                if (error) {
                    console.error('Error loading categories:', error);
                    return;
                }
                
                const parentCategories = allCategories?.filter(cat => !cat.parent_id) || [];
                const subcategories = allCategories?.filter(cat => cat.parent_id) || [];
                
                // Store globally for mobile functions
                window.allCategoriesForDropdown = allCategories;
                
                const dropdownContent = document.getElementById('categories-dropdown');
                if (dropdownContent && parentCategories.length > 0) {
                    dropdownContent.innerHTML = createDynamicCategoriesDropdown(parentCategories, subcategories);
                } else if (dropdownContent) {
                    // Fallback to static content if no categories
                    dropdownContent.innerHTML = getStaticCategoriesDropdown();
                }
                
            } catch (error) {
                console.error('Error loading categories for dropdown:', error);
            }
        }
        
        // Create dynamic categories dropdown with enhanced subcategories
        function createDynamicCategoriesDropdown(categories, subcategories) {
            const categoryIcons = {
                'brake-system': 'fas fa-stop-circle',
                'air-pressure': 'fas fa-wind', 
                'electrical': 'fas fa-bolt',
                'chassis-suspension': 'fas fa-car-side',
                'cooling': 'fas fa-snowflake',
                'clutch-gearbox': 'fas fa-cog',
                'steering-axles': 'fas fa-steering-wheel',
                'bodywork': 'fas fa-car',
                'hvac': 'fas fa-thermometer-half',
                'interior': 'fas fa-chair',
                'silicone-hose': 'fas fa-grip-lines',
                'abc-raufoss-air-couplings': 'fas fa-plug'
            };
            
            return `
                <div class="py-4">
                    <h4 class="font-semibold mb-4 text-center">Van Hool Parts Categories</h4>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 lg:gap-4">
                        ${categories.map(category => {
                            const categorySubcats = subcategories.filter(sub => sub.parent_id === category.id);
                            const icon = categoryIcons[category.slug] || 'fas fa-cog';
                            
                            return `
                                <div class="relative group/category">
                                    <a href="?category=${category.slug}" class="flex items-center p-3 rounded-lg hover:bg-red-50 border transition-colors cursor-pointer" 
                                       onclick="handleCategoryClick(event, '${category.slug}')"
                                       ontouchstart="handleCategoryTouch(event, '${category.slug}')">
                                        <div class="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center mr-3">
                                            <i class="${icon} text-red-600"></i>
                                        </div>
                                        <div class="flex-1">
                                            <div class="font-medium">${category.name_en || category.name || 'Unknown Category'}</div>
                                            <div class="text-sm text-gray-500">${categorySubcats.length} subcategories</div>
                                        </div>
                                        ${categorySubcats.length > 0 ? '<i class="fas fa-chevron-right text-gray-400 group-hover/category:text-red-600 transition-transform duration-200"></i>' : ''}
                                    </a>
                                    ${categorySubcats.length > 0 ? `
                                        <!-- Desktop Hover Dropdown -->
                                        <div class="absolute left-full top-0 ml-2 w-72 bg-white border rounded-lg shadow-2xl opacity-0 invisible group-hover/category:opacity-100 group-hover/category:visible transition-all duration-300 z-[70] hidden lg:block">
                                            <div class="p-4">
                                                <div class="text-sm font-semibold text-gray-900 mb-3 border-b border-gray-200 pb-2 flex items-center">
                                                    <i class="${icon} text-red-600 mr-2"></i>
                                                    ${category.name_en || category.name || 'Unknown'}
                                                </div>
                                                <div class="max-h-64 overflow-y-auto">
                                                    ${categorySubcats.map(subcat => `
                                                        <a href="?category=${subcat.slug}" class="block px-3 py-2 text-sm text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-md transition-colors flex items-center">
                                                            <i class="fas fa-arrow-right text-xs text-gray-400 mr-2"></i>
                                                            ${subcat.name_en || subcat.name || 'Unknown'}
                                                        </a>
                                                    `).join('')}
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Mobile Dropdown -->
                                        <div id="mobile-subcats-${category.id}" class="lg:hidden mt-2 bg-gray-50 rounded-lg border hidden transition-all duration-300">
                                            <div class="p-3">
                                                <div class="text-sm font-medium text-gray-900 mb-2">
                                                    ${category.name_en || category.name || 'Unknown'} Subcategories:
                                                </div>
                                                ${categorySubcats.map(subcat => `
                                                    <a href="?category=${subcat.slug}" class="block px-2 py-1.5 text-sm text-gray-600 hover:bg-white hover:text-red-600 rounded transition-colors">
                                                        ‚Ä¢ ${subcat.name_en || subcat.name || 'Unknown'}
                                                    </a>
                                                `).join('')}
                                            </div>
                                        </div>
                                    ` : ''}
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
            `;
        }

        // Handle category clicks for mobile/desktop
        function handleCategoryClick(event, categorySlug) {
            // On mobile, if there are subcategories, show them instead of navigating
            if (window.innerWidth < 1024) { // lg breakpoint
                const subcatsDiv = document.getElementById(`mobile-subcats-${getCategoryIdBySlug(categorySlug)}`);
                if (subcatsDiv) {
                    event.preventDefault();
                    
                    // Toggle visibility
                    const isHidden = subcatsDiv.classList.contains('hidden');
                    
                    // Hide all other mobile subcategories
                    document.querySelectorAll('[id^="mobile-subcats-"]').forEach(div => {
                        div.classList.add('hidden');
                        // Reset all chevrons
                        const parentLink = div.parentElement.querySelector('a');
                        if (parentLink) {
                            const chevron = parentLink.querySelector('.fa-chevron-right');
                            if (chevron) chevron.style.transform = 'rotate(0deg)';
                        }
                    });
                    
                    // Show this one if it was hidden
                    if (isHidden) {
                        subcatsDiv.classList.remove('hidden');
                        
                        // Rotate chevron
                        const chevron = event.currentTarget.querySelector('.fa-chevron-right');
                        if (chevron) {
                            chevron.style.transform = 'rotate(90deg)';
                        }
                    } else {
                        // Reset chevron
                        const chevron = event.currentTarget.querySelector('.fa-chevron-right');
                        if (chevron) {
                            chevron.style.transform = 'rotate(0deg)';
                        }
                    }
                }
            }
            // On desktop, normal navigation happens via the href
        }

        // Handle touch events for better mobile experience
        function handleCategoryTouch(event, categorySlug) {
            // This helps with touch responsiveness on mobile
            if (window.innerWidth < 1024) {
                event.preventDefault();
            }
        }

        // Helper function to get category ID by slug (needed for mobile subcategories)
        function getCategoryIdBySlug(slug) {
            if (window.allCategoriesForDropdown) {
                const category = window.allCategoriesForDropdown.find(cat => cat.slug === slug && !cat.parent_id);
                return category ? category.id : null;
            }
            return null;
        }
        
        // Translation system
        const translations = {
            en: {
                page_title: "Van Hool Parts Catalog - Rare Bus Parts & Components",
                meta_description: "Browse our complete catalog of Van Hool bus parts. Find brake systems, air pressure components, suspension parts and more.",
                title: "Van Hool Parts Catalog", 
                subtitle: "Find the perfect part for your Van Hool bus",
                filters: "Filters",
                search: "Search",
                search_placeholder: "Search by part code or name...",
                category: "Category",
                all_categories: "All Categories",
                price_range: "Price Range",
                availability: "Availability", 
                in_stock: "In Stock",
                featured: "Featured",
                clear_filters: "Clear Filters",
                sort_by: "Sort by:",
                sort_name: "Name",
                sort_price_low: "Price: Low to High",
                sort_price_high: "Price: High to Low", 
                sort_featured: "Featured",
                loading: "Loading products...",
                no_results: "No products found",
                no_results_desc: "Try adjusting your filters or search terms",
                add_to_cart: "Add to Cart"
            },
            ro: {
                page_title: "Catalog Piese Van Hool - Piese Rare Autobuze & Componente",
                meta_description: "RƒÉsfoie»ôte catalogul nostru complet de piese pentru autobuze Van Hool. GƒÉse»ôte sisteme de fr√¢nare, componente presiune aer, piese suspensie »ôi multe altele.",
                title: "Catalog Piese Van Hool",
                subtitle: "GƒÉse»ôte piesa perfectƒÉ pentru autobuzul tƒÉu Van Hool",
                filters: "Filtre",
                search: "CƒÉutare", 
                search_placeholder: "CautƒÉ dupƒÉ cod piesƒÉ sau nume...",
                category: "Categorie",
                all_categories: "Toate Categoriile",
                price_range: "Interval Pre»õ",
                availability: "Disponibilitate",
                in_stock: "√én Stoc",
                featured: "Recomandate",
                clear_filters: "»òterge Filtrele",
                sort_by: "SorteazƒÉ dupƒÉ:",
                sort_name: "Nume", 
                sort_price_low: "Pre»õ: De la mic la mare",
                sort_price_high: "Pre»õ: De la mare la mic",
                sort_featured: "Recomandate",
                loading: "Se √ÆncarcƒÉ produsele...",
                no_results: "Nu s-au gƒÉsit produse",
                no_results_desc: "√éncearcƒÉ sƒÉ ajustezi filtrele sau termenii de cƒÉutare",
                add_to_cart: "AdaugƒÉ √Æn Co»ô"
            },
            ru: {
                page_title: "–ö–∞—Ç–∞–ª–æ–≥ –∑–∞–ø—á–∞—Å—Ç–µ–π Van Hool - –†–µ–¥–∫–∏–µ –∑–∞–ø—á–∞—Å—Ç–∏ –¥–ª—è –∞–≤—Ç–æ–±—É—Å–æ–≤ –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã",
                meta_description: "–ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞—à –ø–æ–ª–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ –∑–∞–ø—á–∞—Å—Ç–µ–π –¥–ª—è –∞–≤—Ç–æ–±—É—Å–æ–≤ Van Hool. –ù–∞–π–¥–∏—Ç–µ —Ç–æ—Ä–º–æ–∑–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã, –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–Ω–µ–≤–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–∏—Å—Ç–µ–º—ã, –¥–µ—Ç–∞–ª–∏ –ø–æ–¥–≤–µ—Å–∫–∏ –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ.",
                title: "–ö–∞—Ç–∞–ª–æ–≥ –∑–∞–ø—á–∞—Å—Ç–µ–π Van Hool",
                subtitle: "–ù–∞–π–¥–∏—Ç–µ –∏–¥–µ–∞–ª—å–Ω—É—é –∑–∞–ø—á–∞—Å—Ç—å –¥–ª—è –≤–∞—à–µ–≥–æ –∞–≤—Ç–æ–±—É—Å–∞ Van Hool",
                filters: "–§–∏–ª—å—Ç—Ä—ã",
                search: "–ü–æ–∏—Å–∫",
                search_placeholder: "–ü–æ–∏—Å–∫ –ø–æ –∫–æ–¥—É –∑–∞–ø—á–∞—Å—Ç–∏ –∏–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏—é...",
                category: "–ö–∞—Ç–µ–≥–æ—Ä–∏—è", 
                all_categories: "–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏",
                price_range: "–î–∏–∞–ø–∞–∑–æ–Ω —Ü–µ–Ω",
                availability: "–ù–∞–ª–∏—á–∏–µ",
                in_stock: "–í –Ω–∞–ª–∏—á–∏–∏",
                featured: "–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ",
                clear_filters: "–û—á–∏—Å—Ç–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã",
                sort_by: "–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:",
                sort_name: "–ù–∞–∑–≤–∞–Ω–∏–µ",
                sort_price_low: "–¶–µ–Ω–∞: –ü–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é", 
                sort_price_high: "–¶–µ–Ω–∞: –ü–æ —É–±—ã–≤–∞–Ω–∏—é",
                sort_featured: "–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ",
                loading: "–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤...",
                no_results: "–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã",
                no_results_desc: "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –∏–ª–∏ —É—Å–ª–æ–≤–∏—è –ø–æ–∏—Å–∫–∞",
                add_to_cart: "–í –∫–æ—Ä–∑–∏–Ω—É"
            }
        };
        
        let allProducts = [];
        let filteredProducts = [];
        
        // Make products globally accessible for cart functions
        window.allProducts = allProducts;
        window.filteredProducts = filteredProducts;
        let currentPage = 1;
        const itemsPerPage = 12;
        
        // Get current language from universal app
        let currentLang = 'en';
        
        // Use universal language function  
        function updateTranslations() {
            // Get current language from universal system
            if (window.VanHoolApp && window.VanHoolApp.currentLanguage) {
                currentLang = window.VanHoolApp.currentLanguage;
            } else {
                currentLang = 'en';
            }
            
            const elements = document.querySelectorAll('[data-translate]');
            elements.forEach(el => {
                const key = el.getAttribute('data-translate');
                if (translations[currentLang] && translations[currentLang][key]) {
                    el.textContent = translations[currentLang][key];
                }
            });
            
            // Update placeholders
            const placeholderElements = document.querySelectorAll('[data-translate-placeholder]');
            placeholderElements.forEach(el => {
                const key = el.getAttribute('data-translate-placeholder');
                if (translations[currentLang] && translations[currentLang][key]) {
                    el.placeholder = translations[currentLang][key];
                }
            });
        }
        
        // Load categories
        async function loadCategories() {
            try {
                // Update current language from universal app
                if (window.VanHoolApp && window.VanHoolApp.currentLanguage) {
                    currentLang = window.VanHoolApp.currentLanguage;
                }
                
                console.log('üîç Loading categories from Supabase...');
                
                // Get all categories without strict filtering
                const { data: categories, error } = await window.supabase
                    .from('categories')
                    .select('*')
                    .order('sort_order');
                
                const categoryFilter = document.getElementById('category-filter');
                
                if (error) {
                    console.error('Supabase categories error:', error);
                    throw error;
                }
                
                if (!categories || categories.length === 0) {
                    console.log('No categories found in database, using demo categories');
                    // Add demo categories
                    const demoCategories = [
                        { slug: 'brake-system', name_en: 'Brake System', name_ro: 'Sistem Fr√¢nare', name_ru: '–¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞' },
                        { slug: 'air-pressure', name_en: 'Air Pressure', name_ro: 'Presiune Aer', name_ru: '–ü–Ω–µ–≤–º–∞—Ç–∏–∫–∞' },
                        { slug: 'chassis-suspension', name_en: 'Chassis & Suspension', name_ro: '»òasiu & Suspensie', name_ru: '–®–∞—Å—Å–∏ –∏ –ø–æ–¥–≤–µ—Å–∫–∞' },
                        { slug: 'electrical', name_en: 'Electrical System', name_ro: 'Sistem Electric', name_ru: '–≠–ª–µ–∫—Ç—Ä–æ–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ' }
                    ];
                    
                    demoCategories.forEach(cat => {
                        const option = document.createElement('option');
                        option.value = cat.slug;
                        option.textContent = cat[`name_${currentLang}`] || cat.name_en;
                        categoryFilter.appendChild(option);
                    });
                    return;
                }
                
                console.log(`‚úÖ Loaded ${categories.length} categories from database`);
                categories.forEach(cat => {
                    const option = document.createElement('option');
                    option.value = cat.slug;
                    option.textContent = cat[`name_${currentLang}`] || cat.name_en;
                    categoryFilter.appendChild(option);
                });
                
            } catch (error) {
                console.error('Error loading categories:', error);
            }
        }
        
        // Load products
        async function loadProducts() {
            try {
                console.log('üîç Loading products from Supabase...');
                
                // Use standardized query for all active products
                const productsQuery = window.DB_QUERIES.getProducts({
                    activeOnly: true,
                    inStockOnly: false
                });
                
                const { data: products, error } = await productsQuery;
                
                if (error) {
                    console.error('Supabase error:', error);
                    throw error;
                }
                
                if (products && products.length > 0) {
                    console.log(`‚úÖ Loaded ${products.length} products from database`);
                    allProducts = products;
                    window.allProducts = allProducts;
                } else {
                    console.log('No products found in database, using demo products');
                    allProducts = getDemoProducts();
                    window.allProducts = allProducts;
                }
                
                filteredProducts = [...allProducts];
                window.filteredProducts = filteredProducts;
                renderProducts();
                
            } catch (error) {
                console.error('Error loading products:', error);
                console.log('Using demo products as fallback');
                allProducts = getDemoProducts();
                window.allProducts = allProducts;
                filteredProducts = [...allProducts];
                window.filteredProducts = filteredProducts;
                renderProducts();
            } finally {
                document.getElementById('loading-products').style.display = 'none';
            }
        }
        
        // Demo products
        function getDemoProducts() {
            return [
                {
                    id: '1',
                    part_code: 'VH-BP-F-AG300-001',
                    slug: 'brake-pad-front-vanhool-ag300',
                    name_en: 'Front Brake Pads Van Hool AG300',
                    name_ro: 'PlƒÉcu»õe Fr√¢nƒÉ Fa»õƒÉ Van Hool AG300',
                    name_ru: '–ü–µ—Ä–µ–¥–Ω–∏–µ —Ç–æ—Ä–º–æ–∑–Ω—ã–µ –∫–æ–ª–æ–¥–∫–∏ Van Hool AG300',
                    description_en: 'Original Van Hool front brake pads for AG300 bus model.',
                    description_ro: 'PlƒÉcu»õe de fr√¢nƒÉ originale Van Hool pentru modelul AG300.',
                    description_ru: '–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–¥–Ω–∏–µ —Ç–æ—Ä–º–æ–∑–Ω—ã–µ –∫–æ–ª–æ–¥–∫–∏ Van Hool –¥–ª—è –º–æ–¥–µ–ª–∏ AG300.',
                    price: 125.99,
                    stock_quantity: 15,
                    is_featured: true,
                    image_url: null,
                    categories: {
                        id: '1',
                        slug: 'brake-system',
                        name_en: 'Brake System',
                        name_ro: 'Sistem Fr√¢nare',
                        name_ru: '–¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'
                    }
                },
                {
                    id: '2', 
                    part_code: 'VH-AS-R-A330-002',
                    slug: 'air-suspension-rear-vanhool-a330',
                    name_en: 'Rear Air Suspension Van Hool A330',
                    name_ro: 'Suspensie PneumaticƒÉ Spate Van Hool A330',
                    name_ru: '–ó–∞–¥–Ω—è—è –ø–Ω–µ–≤–º–æ–ø–æ–¥–≤–µ—Å–∫–∞ Van Hool A330',
                    description_en: 'Original Van Hool rear air suspension system for A330 coach.',
                    description_ro: 'Sistem original de suspensie pneumaticƒÉ spate Van Hool pentru A330.',
                    description_ru: '–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞–¥–Ω–µ–π –ø–Ω–µ–≤–º–æ–ø–æ–¥–≤–µ—Å–∫–∏ Van Hool –¥–ª—è A330.',
                    price: 890.50,
                    stock_quantity: 8,
                    is_featured: true,
                    image_url: null,
                    categories: {
                        id: '2',
                        slug: 'chassis-suspension',
                        name_en: 'Chassis & Suspension',
                        name_ro: '»òasiu & Suspensie', 
                        name_ru: '–®–∞—Å—Å–∏ –∏ –ø–æ–¥–≤–µ—Å–∫–∞'
                    }
                },
                {
                    id: '3',
                    part_code: 'VH-AC-C-T815-003',
                    slug: 'air-compressor-vanhool-t815',
                    name_en: 'Air Compressor Van Hool T815',
                    name_ro: 'Compresor Aer Van Hool T815',
                    name_ru: '–í–æ–∑–¥—É—à–Ω—ã–π –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä Van Hool T815',
                    description_en: 'Original Van Hool air compressor for T815 bus model.',
                    description_ro: 'Compresor de aer original Van Hool pentru modelul T815.',
                    description_ru: '–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –≤–æ–∑–¥—É—à–Ω—ã–π –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä Van Hool –¥–ª—è –º–æ–¥–µ–ª–∏ T815.',
                    price: 1250.00,
                    stock_quantity: 5,
                    is_featured: false,
                    image_url: null,
                    categories: {
                        id: '3',
                        slug: 'air-pressure',
                        name_en: 'Air Pressure',
                        name_ro: 'Presiune Aer',
                        name_ru: '–ü–Ω–µ–≤–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞'
                    }
                },
                {
                    id: '4',
                    part_code: 'VH-HL-F-A330-004',
                    slug: 'headlight-front-vanhool-a330',
                    name_en: 'Front Headlight Van Hool A330',
                    name_ro: 'Far Frontal Van Hool A330',
                    name_ru: '–ü–µ—Ä–µ–¥–Ω—è—è —Ñ–∞—Ä–∞ Van Hool A330',
                    description_en: 'Original Van Hool front headlight assembly for A330 coach.',
                    description_ro: 'Ansamblu far frontal original Van Hool pentru A330.',
                    description_ru: '–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–¥–Ω—è—è —Ñ–∞—Ä–∞ Van Hool –¥–ª—è A330.',
                    price: 420.75,
                    stock_quantity: 12,
                    is_featured: true,
                    image_url: null,
                    categories: {
                        id: '4',
                        slug: 'electrical',
                        name_en: 'Electrical System',
                        name_ro: 'Sistem Electric',
                        name_ru: '–≠–ª–µ–∫—Ç—Ä–æ–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ'
                    }
                },
                {
                    id: '5',
                    part_code: 'VH-BD-R-AG300-005',
                    slug: 'brake-disc-rear-vanhool-ag300',
                    name_en: 'Rear Brake Disc Van Hool AG300',
                    name_ro: 'Disc Fr√¢nƒÉ Spate Van Hool AG300',
                    name_ru: '–ó–∞–¥–Ω–∏–π —Ç–æ—Ä–º–æ–∑–Ω–æ–π –¥–∏—Å–∫ Van Hool AG300',
                    description_en: 'Original Van Hool rear brake disc for AG300 bus.',
                    description_ro: 'Disc de fr√¢nƒÉ spate original Van Hool pentru AG300.',
                    description_ru: '–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∑–∞–¥–Ω–∏–π —Ç–æ—Ä–º–æ–∑–Ω–æ–π –¥–∏—Å–∫ Van Hool –¥–ª—è AG300.',
                    price: 285.00,
                    stock_quantity: 10,
                    is_featured: false,
                    image_url: null,
                    categories: {
                        id: '1',
                        slug: 'brake-system',
                        name_en: 'Brake System',
                        name_ro: 'Sistem Fr√¢nare',
                        name_ru: '–¢–æ—Ä–º–æ–∑–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'
                    }
                },
                {
                    id: '6',
                    part_code: 'VH-AV-S-T815-006',
                    slug: 'air-valve-safety-vanhool-t815',
                    name_en: 'Safety Air Valve Van Hool T815',
                    name_ro: 'ValvƒÉ Aer Siguran»õƒÉ Van Hool T815',
                    name_ru: '–ü—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å–Ω—ã–π –≤–æ–∑–¥—É—à–Ω—ã–π –∫–ª–∞–ø–∞–Ω Van Hool T815',
                    description_en: 'Original Van Hool safety air valve for T815 model.',
                    description_ro: 'ValvƒÉ de siguran»õƒÉ aer original Van Hool pentru T815.',
                    description_ru: '–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –ø—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å–Ω—ã–π –≤–æ–∑–¥—É—à–Ω—ã–π –∫–ª–∞–ø–∞–Ω Van Hool –¥–ª—è T815.',
                    price: 95.50,
                    stock_quantity: 20,
                    is_featured: false,
                    image_url: null,
                    categories: {
                        id: '3',
                        slug: 'air-pressure',
                        name_en: 'Air Pressure',
                        name_ro: 'Presiune Aer',
                        name_ru: '–ü–Ω–µ–≤–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞'
                    }
                }
            ];
        }
        
        // Render products
        function renderProducts() {
            // Update current language from universal app
            if (window.VanHoolApp && window.VanHoolApp.currentLanguage) {
                currentLang = window.VanHoolApp.currentLanguage;
            }
            
            const grid = document.getElementById('products-grid');
            const resultsCount = document.getElementById('results-count');
            const noResults = document.getElementById('no-results');
            const pagination = document.getElementById('pagination');
            
            // Calculate pagination
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const pageProducts = filteredProducts.slice(startIndex, endIndex);
            
            // Update results count
            resultsCount.textContent = `Showing ${pageProducts.length} of ${filteredProducts.length} products`;
            
            if (pageProducts.length === 0) {
                grid.style.display = 'none';
                noResults.classList.remove('hidden');
                pagination.classList.add('hidden');
                return;
            }
            
            grid.style.display = 'grid';
            noResults.classList.add('hidden');
            
            // Render products
            grid.innerHTML = pageProducts.map(product => `
                <div class="bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow overflow-hidden border">
                    <a href="product.html?id=${product.id}&code=${product.part_code}" class="block">
                        <div class="aspect-w-1 aspect-h-1 bg-gray-100">
                            ${product.image_url ? 
                                `<img src="${product.image_url}" alt="${product[`name_${currentLang}`] || product.name_en}" class="w-full h-48 object-cover">` :
                                `<div class="w-full h-48 bg-gray-200 flex items-center justify-center">
                                    <i class="fas fa-image text-gray-400 text-4xl"></i>
                                </div>`
                            }
                        </div>
                        <div class="p-4">
                            <div class="text-sm text-red-600 font-medium mb-1">${product.part_code}</div>
                            <h3 class="font-semibold text-gray-900 mb-2 line-clamp-2">
                                ${product[`name_${currentLang}`] || product.name_en}
                            </h3>
                            <p class="text-sm text-gray-600 mb-3 line-clamp-2">
                                ${product[`description_${currentLang}`] || product.description_en || ''}
                            </p>
                            <div class="flex items-center justify-between mb-3">
                                <span class="text-lg font-bold text-gray-900">‚Ç¨${product.price}</span>
                                <span class="text-sm ${product.stock_quantity > 0 ? 'text-green-600' : 'text-red-600'}">
                                    ${product.stock_quantity > 0 ? translations[currentLang].in_stock : 'Out of Stock'}
                                </span>
                            </div>
                        </div>
                    </a>
                    <div class="px-4 pb-4">
                        <button onclick="addToCartLocal('${product.id}')" 
                                class="w-full bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 transition-colors ${product.stock_quantity === 0 ? 'opacity-50 cursor-not-allowed' : ''}"
                                ${product.stock_quantity === 0 ? 'disabled' : ''}>
                            <i class="fas fa-cart-plus mr-2"></i>
                            ${translations[currentLang].add_to_cart}
                        </button>
                    </div>
                </div>
            `).join('');
            
            // Update pagination
            updatePagination();
        }
        
        // Update pagination
        function updatePagination() {
            const pagination = document.getElementById('pagination');
            const pageInfo = document.getElementById('page-info');
            const prevBtn = document.getElementById('prev-page');
            const nextBtn = document.getElementById('next-page');
            
            const totalPages = Math.ceil(filteredProducts.length / itemsPerPage);
            
            if (totalPages <= 1) {
                pagination.classList.add('hidden');
                return;
            }
            
            pagination.classList.remove('hidden');
            pageInfo.textContent = `Page ${currentPage} of ${totalPages}`;
            
            prevBtn.disabled = currentPage === 1;
            nextBtn.disabled = currentPage === totalPages;
        }
        
        // Add to cart function
        async function addToCartLocal(productId) {
            try {
                // Wait for cart manager to be available
                if (!window.cartManager) {
                    console.warn('Cart manager not available yet, waiting...');
                    await new Promise(resolve => {
                        const checkCartManager = () => {
                            if (window.cartManager) {
                                resolve();
                            } else {
                                setTimeout(checkCartManager, 100);
                            }
                        };
                        checkCartManager();
                    });
                }
                
                // Find the product in our loaded data
                let product = null;
                
                // First try to find in filteredProducts
                if (window.filteredProducts) {
                    product = window.filteredProducts.find(p => p.id == productId);
                }
                
                // If not found, try allProducts
                if (!product && window.allProducts) {
                    product = window.allProducts.find(p => p.id == productId);
                }
                
                // If still not found, create a mock product for demo
                if (!product) {
                    product = {
                        id: productId,
                        name: 'Demo Product',
                        sku: 'DEMO-' + productId,
                        price: 99.99,
                        sale_price: null,
                        stock_quantity: 10,
                        is_active: true,
                        images: ['/images/placeholder.jpg'],
                        categories: { name: 'Demo Category' },
                        brands: { name: 'Demo Brand' }
                    };
                }
                
                // Add to cart
                const result = await window.cartManager.addItem(productId, 1, {
                    productDetails: {
                        ...product,
                        is_active: true,
                        stock_quantity: product.stock_quantity || 10
                    },
                    name: product.name_en || product.name || product.name_ro || 'Product',
                    sku: product.sku,
                    price: product.sale_price || product.price,
                    originalPrice: product.price,
                    image: product.images?.[0] || '/images/placeholder.jpg',
                    category: product.categories?.name || product.category || '',
                    brand: product.brands?.name || product.brand || ''
                });
                
                if (result.success) {
                    showNotification(result.message || 'Produs adƒÉugat √Æn co»ô', 'success');
                    updateCartCounter();
                } else {
                    showNotification(result.error || 'Eroare la adƒÉugarea √Æn co»ô', 'error');
                }
                
            } catch (error) {
                console.error('Error adding to cart:', error);
                showNotification('Eroare la adƒÉugarea √Æn co»ô', 'error');
            }
        }
        
        // Update cart counter in navigation
        function updateCartCounter() {
            if (window.cartManager) {
                const itemCount = window.cartManager.getItemCount();
                const counter = document.getElementById('cart-counter');
                const mobileCounter = document.getElementById('mobile-cart-counter');
                
                if (itemCount > 0) {
                    if (counter) {
                        counter.textContent = itemCount;
                        counter.classList.remove('hidden');
                    }
                    if (mobileCounter) {
                        mobileCounter.textContent = itemCount;
                        mobileCounter.classList.remove('hidden');
                    }
                } else {
                    if (counter) counter.classList.add('hidden');
                    if (mobileCounter) mobileCounter.classList.add('hidden');
                }
            }
        }
        
        // Show notification
        function showNotification(message, type = 'info') {
            // Remove existing notifications
            const existing = document.querySelectorAll('.cart-notification');
            existing.forEach(n => n.remove());
            
            const notification = document.createElement('div');
            notification.className = `cart-notification fixed top-4 right-4 p-4 rounded-md shadow-lg z-50 max-w-sm ${
                type === 'error' ? 'bg-red-100 border border-red-400 text-red-700' :
                type === 'success' ? 'bg-green-100 border border-green-400 text-green-700' :
                'bg-red-100 border border-blue-400 text-red-700'
            }`;
            
            notification.innerHTML = `
                <div class="flex items-start">
                    <i class="fas ${
                        type === 'error' ? 'fa-exclamation-circle' :
                        type === 'success' ? 'fa-check-circle' :
                        'fa-info-circle'
                    } mt-0.5 mr-2 flex-shrink-0"></i>
                    <div class="flex-1">${message}</div>
                    <button type="button" class="ml-3 flex-shrink-0 hover:opacity-75" onclick="this.parentElement.parentElement.remove()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Auto remove after 4 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 4000);
        }
        
        // Sort products function
        function sortProducts() {
            const sortValue = document.getElementById('sort-select').value;
            
            // Update current language from universal app
            if (window.VanHoolApp && window.VanHoolApp.currentLanguage) {
                currentLang = window.VanHoolApp.currentLanguage;
            }
            
            switch (sortValue) {
                case 'name':
                    filteredProducts.sort((a, b) => {
                        const nameA = (a[`name_${currentLang}`] || a.name_en || '').toLowerCase();
                        const nameB = (b[`name_${currentLang}`] || b.name_en || '').toLowerCase();
                        return nameA.localeCompare(nameB);
                    });
                    break;
                case 'price_asc':
                    filteredProducts.sort((a, b) => (a.price || 0) - (b.price || 0));
                    break;
                case 'price_desc':
                    filteredProducts.sort((a, b) => (b.price || 0) - (a.price || 0));
                    break;
                case 'featured':
                    filteredProducts.sort((a, b) => {
                        // Featured first, then by name
                        if (a.is_featured && !b.is_featured) return -1;
                        if (!a.is_featured && b.is_featured) return 1;
                        const nameA = (a[`name_${currentLang}`] || a.name_en || '').toLowerCase();
                        const nameB = (b[`name_${currentLang}`] || b.name_en || '').toLowerCase();
                        return nameA.localeCompare(nameB);
                    });
                    break;
                default:
                    // Default to name sort
                    filteredProducts.sort((a, b) => {
                        const nameA = (a[`name_${currentLang}`] || a.name_en || '').toLowerCase();
                        const nameB = (b[`name_${currentLang}`] || b.name_en || '').toLowerCase();
                        return nameA.localeCompare(nameB);
                    });
            }
            
            currentPage = 1;
            renderProducts();
        }
        
        // Apply current sort without rendering
        function applyCurrentSort() {
            const sortValue = document.getElementById('sort-select').value;
            
            // Update current language from universal app
            if (window.VanHoolApp && window.VanHoolApp.currentLanguage) {
                currentLang = window.VanHoolApp.currentLanguage;
            }
            
            switch (sortValue) {
                case 'name':
                    filteredProducts.sort((a, b) => {
                        const nameA = (a[`name_${currentLang}`] || a.name_en || '').toLowerCase();
                        const nameB = (b[`name_${currentLang}`] || b.name_en || '').toLowerCase();
                        return nameA.localeCompare(nameB);
                    });
                    break;
                case 'price_asc':
                    filteredProducts.sort((a, b) => (a.price || 0) - (b.price || 0));
                    break;
                case 'price_desc':
                    filteredProducts.sort((a, b) => (b.price || 0) - (a.price || 0));
                    break;
                case 'featured':
                    filteredProducts.sort((a, b) => {
                        // Featured first, then by name
                        if (a.is_featured && !b.is_featured) return -1;
                        if (!a.is_featured && b.is_featured) return 1;
                        const nameA = (a[`name_${currentLang}`] || a.name_en || '').toLowerCase();
                        const nameB = (b[`name_${currentLang}`] || b.name_en || '').toLowerCase();
                        return nameA.localeCompare(nameB);
                    });
                    break;
                default:
                    // Default to name sort
                    filteredProducts.sort((a, b) => {
                        const nameA = (a[`name_${currentLang}`] || a.name_en || '').toLowerCase();
                        const nameB = (b[`name_${currentLang}`] || b.name_en || '').toLowerCase();
                        return nameA.localeCompare(nameB);
                    });
            }
        }
        
        // Apply all filters function
        function applyFilters() {
            // Get filter values
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            const selectedCategory = document.getElementById('category-filter').value;
            const minPrice = parseFloat(document.getElementById('min-price').value) || 0;
            const maxPrice = parseFloat(document.getElementById('max-price').value) || Infinity;
            const inStockOnly = document.getElementById('in-stock-filter').checked;
            const featuredOnly = document.getElementById('featured-filter').checked;
            
            console.log('üîç Applying filters:', {
                searchTerm,
                selectedCategory,
                minPrice,
                maxPrice,
                inStockOnly,
                featuredOnly,
                totalProducts: allProducts.length
            });
            
            // Apply all filters
            filteredProducts = allProducts.filter(product => {
                // Search filter
                const searchMatch = !searchTerm || 
                    product.part_code.toLowerCase().includes(searchTerm) ||
                    (product[`name_${currentLang}`] || product.name_en).toLowerCase().includes(searchTerm) ||
                    (product.description_en && product.description_en.toLowerCase().includes(searchTerm));
                
                // Category filter - improved logic with debugging
                let categoryMatch = true;
                if (selectedCategory) {
                    categoryMatch = false;
                    
                    // Check various category properties
                    if (product.category_slug === selectedCategory) {
                        categoryMatch = true;
                    } else if (product.categories && product.categories.slug === selectedCategory) {
                        categoryMatch = true;
                    } else if (product.category_id) {
                        // Try to match by category ID if we have it
                        const categoryId = getCategoryIdBySlug(selectedCategory);
                        if (categoryId && product.category_id === categoryId) {
                            categoryMatch = true;
                        }
                    }
                    
                    // Debug logging for category filtering issues
                    if (!categoryMatch) {
                        console.log(`Product ${product.part_code} doesn't match category ${selectedCategory}:`, {
                            product_category_slug: product.category_slug,
                            product_categories: product.categories,
                            product_category_id: product.category_id,
                            selected_category: selectedCategory
                        });
                    }
                }
                
                // Price filter
                const price = parseFloat(product.price) || 0;
                const priceMatch = price >= minPrice && price <= maxPrice;
                
                // Stock filter
                const stockMatch = !inStockOnly || (product.stock_quantity > 0);
                
                // Featured filter
                const featuredMatch = !featuredOnly || product.is_featured;
                
                return searchMatch && categoryMatch && priceMatch && stockMatch && featuredMatch;
            });
            
            currentPage = 1;
            
            console.log(`‚úÖ Filtering complete: ${filteredProducts.length} products match filters`);
            
            // Update window reference
            window.filteredProducts = filteredProducts;
            
            // Apply current sort after filtering (without calling renderProducts again)
            const sortValue = document.getElementById('sort-select').value;
            applyCurrentSort();
            
            renderProducts();
        }
        
        // Load categories for filter dropdown
        async function loadCategoriesForFilter() {
            try {
                const { data: allCategories, error } = await window.supabase
                    .from('categories')
                    .select('*')
                    .order('sort_order');
                
                if (error) {
                    console.error('Error loading categories for filter:', error);
                    return;
                }

                const categoryFilter = document.getElementById('category-filter');
                if (categoryFilter && allCategories) {
                    // Clear existing options except "All Categories"
                    categoryFilter.innerHTML = '<option value="" data-translate="all_categories">All Categories</option>';
                    
                    // Add all categories (both parent and subcategories) for filtering
                    allCategories.forEach(cat => {
                        const option = document.createElement('option');
                        option.value = cat.slug;
                        
                        // Indent subcategories to show hierarchy
                        const displayName = cat.parent_id ? 
                            `  ‚îî ${cat.name_en || cat.name || 'Unknown'}` : 
                            cat.name_en || cat.name || 'Unknown';
                        
                        option.textContent = displayName;
                        categoryFilter.appendChild(option);
                    });
                }
                
            } catch (error) {
                console.error('Error loading categories for filter:', error);
            }
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Catalog ready, setting up event listeners...');
            
            // Search filter
            document.getElementById('search-input').addEventListener('input', function(e) {
                applyFilters();
            });
            
            // Category filter
            document.getElementById('category-filter').addEventListener('change', function(e) {
                applyFilters();
            });
            
            // Price range filters
            document.getElementById('min-price').addEventListener('input', function(e) {
                applyFilters();
            });
            
            document.getElementById('max-price').addEventListener('input', function(e) {
                applyFilters();
            });
            
            // Availability filters
            document.getElementById('in-stock-filter').addEventListener('change', function(e) {
                applyFilters();
            });
            
            document.getElementById('featured-filter').addEventListener('change', function(e) {
                applyFilters();
            });
            
            // Sort functionality
            document.getElementById('sort-select').addEventListener('change', function(e) {
                sortProducts();
            });
            
            // Clear filters
            document.getElementById('clear-filters').addEventListener('click', function() {
                document.getElementById('search-input').value = '';
                document.getElementById('category-filter').value = '';
                document.getElementById('min-price').value = '';
                document.getElementById('max-price').value = '';
                document.getElementById('in-stock-filter').checked = false;
                document.getElementById('featured-filter').checked = false;
                filteredProducts = [...allProducts];
                window.filteredProducts = filteredProducts;
                currentPage = 1;
                renderProducts();
            });
            
            // Pagination
            document.getElementById('prev-page').addEventListener('click', function() {
                if (currentPage > 1) {
                    currentPage--;
                    renderProducts();
                }
            });
            
            document.getElementById('next-page').addEventListener('click', function() {
                const totalPages = Math.ceil(filteredProducts.length / itemsPerPage);
                if (currentPage < totalPages) {
                    currentPage++;
                    renderProducts();
                }
            });
            
            // Universal app handles auth dropdowns
        });
        
        // Helper function to get category ID by slug
        function getCategoryIdBySlug(slug) {
            // This would need to be implemented based on how categories are stored
            // For now, return null to avoid errors
            return null;
        }
        
        // Handle URL parameters for filtering
        function handleUrlParameters() {
            const urlParams = new URLSearchParams(window.location.search);
            
            // Handle category filter
            const categoryParam = urlParams.get('category');
            if (categoryParam) {
                console.log(`Setting category filter to: ${categoryParam}`);
                document.getElementById('category-filter').value = categoryParam;
            }
            
            // Handle featured filter
            const featuredParam = urlParams.get('featured');
            if (featuredParam === 'true') {
                document.getElementById('featured-filter').checked = true;
            }
            
            // Handle in stock filter
            const inStockParam = urlParams.get('in_stock');
            if (inStockParam === 'true') {
                document.getElementById('in-stock-filter').checked = true;
            }
            
            // Handle sort
            const sortParam = urlParams.get('sort');
            if (sortParam) {
                document.getElementById('sort-select').value = sortParam;
            }
            
            // Handle price range
            const minPrice = urlParams.get('min_price');
            const maxPrice = urlParams.get('max_price');
            if (minPrice) document.getElementById('min-price').value = minPrice;
            if (maxPrice) document.getElementById('max-price').value = maxPrice;
        }
        
        // Initialize page after everything loads (like index.html)
        window.addEventListener('load', function() {
            console.log('üöÄ Window loaded, initializing catalog...');
            
            // Update current language from universal app
            if (window.VanHoolApp && window.VanHoolApp.currentLanguage) {
                currentLang = window.VanHoolApp.currentLanguage;
            }
            
            // Initialize everything in sequence
            initializeCatalog();
        });
        
        // Initialize catalog in proper sequence
        async function initializeCatalog() {
            try {
                // Load categories first
                await loadCategories();
                await loadCategoriesDropdown();
                await loadCategoriesForFilter();
                
                // Then load products
                await loadProducts();
                
                // Update translations
                updateTranslations();
                
                // Apply URL parameters after everything is loaded
                handleUrlParameters();
                applyFilters();
                
                // Load categories for navigation dropdown
                await loadCategoriesForNavigation();
                
                // Initialize cart counter
                setTimeout(updateCartCounter, 1000);
                
                // Listen for cart events if cart manager becomes available
                const checkForCartManager = () => {
                    if (window.cartManager) {
                        window.cartManager.addListener((event) => {
                            if (['item_added', 'item_removed', 'item_updated', 'cart_cleared', 'cart_synced'].includes(event)) {
                                updateCartCounter();
                            }
                        });
                    } else {
                        setTimeout(checkForCartManager, 500);
                    }
                };
                checkForCartManager();
                
                console.log('‚úÖ Catalog initialization complete');
                
            } catch (error) {
                console.error('Error initializing catalog:', error);
            }
        }
        
        // Load categories for navigation dropdown
        async function loadCategoriesForNavigation() {
            try {
                // Load both parent categories and subcategories
                const { data: allCategories, error } = await window.supabase
                    .from('categories')
                    .select('*')
                    .order('sort_order');
                
                if (error) throw error;
                
                // Separate parent categories and subcategories
                const categories = allCategories?.filter(cat => !cat.parent_id) || [];
                const subcategories = allCategories?.filter(cat => cat.parent_id) || [];
                
                const dropdown = document.getElementById('categories-dropdown');
                
                if (!categories || categories.length === 0) {
                    console.log('Using demo categories for navigation');
                    // dropdown.innerHTML = getDemoCategoriesDropdownForNav();
                    return;
                }
                
                // Enhanced dropdown menu with subcategories
                // dropdown.innerHTML = createCoolCategoriesDropdownForNav(categories, subcategories);
                
            } catch (error) {
                console.error('Error loading categories for navigation:', error);
                // document.getElementById('categories-dropdown').innerHTML = getDemoCategoriesDropdownForNav();
            }
        }
        
        // Create enhanced categories dropdown for navigation
        function createCoolCategoriesDropdownForNav(categories, subcategories) {
            const currentLang = (window.VanHoolApp && window.VanHoolApp.currentLanguage) ? window.VanHoolApp.currentLanguage : 'en';
            
            // Create category icons mapping
            const categoryIcons = {
                'brake-system': 'fas fa-stop-circle',
                'air-pressure': 'fas fa-wind',
                'chassis-suspension': 'fas fa-car-side',
                'electrical': 'fas fa-bolt',
                'engine-parts': 'fas fa-cogs',
                'transmission': 'fas fa-gear',
                'cooling-system': 'fas fa-snowflake',
                'fuel-system': 'fas fa-gas-pump',
                'exhaust-system': 'fas fa-smog',
                'steering': 'fas fa-steering-wheel',
                'lights': 'fas fa-lightbulb',
                'body-parts': 'fas fa-truck'
            };
            
            // Group subcategories by parent
            const subcategoriesMap = {};
            subcategories.forEach(sub => {
                if (!subcategoriesMap[sub.parent_id]) {
                    subcategoriesMap[sub.parent_id] = [];
                }
                subcategoriesMap[sub.parent_id].push(sub);
            });
            
            return `
                <div class="grid grid-cols-2 gap-6">
                    ${categories.map(category => {
                        const categoryName = category[`name_${currentLang}`] || category.name_en;
                        const categoryIcon = categoryIcons[category.slug] || 'fas fa-cogs';
                        const categorySubs = subcategoriesMap[category.id] || [];
                        
                        return `
                            <div class="category-group">
                                <!-- Main Category -->
                                <a href="?category=${category.slug}" 
                                   class="main-category-link flex items-center space-x-3 p-3 rounded-lg hover:bg-red-50 group transition-all duration-200 mb-2 border-2 border-transparent hover:border-blue-200">
                                    <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform duration-200 shadow-md">
                                        <i class="${categoryIcon} text-white text-lg"></i>
                                    </div>
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-900 group-hover:text-red-600 transition-colors">
                                            ${categoryName}
                                        </h4>
                                        <p class="text-xs text-gray-500 mt-1">
                                            ${categorySubs.length} ${categorySubs.length === 1 ? 'subcategory' : 'subcategories'}
                                        </p>
                                    </div>
                                    <i class="fas fa-arrow-right text-gray-400 group-hover:text-red-600 group-hover:translate-x-1 transition-all duration-200"></i>
                                </a>
                                
                                <!-- Subcategories -->
                                ${categorySubs.length > 0 ? `
                                    <div class="subcategories ml-4 space-y-1">
                                        ${categorySubs.slice(0, 4).map(sub => `
                                            <a href="?category=${sub.slug}" 
                                               class="subcategory-link flex items-center space-x-2 py-2 px-3 rounded-md hover:bg-gray-50 group text-sm transition-colors duration-150">
                                                <div class="w-2 h-2 bg-blue-400 rounded-full group-hover:bg-red-600 transition-colors"></div>
                                                <span class="text-gray-600 group-hover:text-gray-900 transition-colors">
                                                    ${sub[`name_${currentLang}`] || sub.name_en}
                                                </span>
                                                <i class="fas fa-external-link-alt text-xs text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity ml-auto"></i>
                                            </a>
                                        `).join('')}
                                        ${categorySubs.length > 4 ? `
                                            <a href="?category=${category.slug}" 
                                               class="inline-flex items-center text-xs text-red-600 hover:text-red-700 ml-4 mt-1">
                                                +${categorySubs.length - 4} more
                                                <i class="fas fa-chevron-right ml-1 text-xs"></i>
                                            </a>
                                        ` : ''}
                                    </div>
                                ` : `
                                    <div class="ml-4 text-xs text-gray-400 italic">No subcategories</div>
                                `}
                            </div>
                        `;
                    }).join('')}
                </div>
                
                <!-- Quick Actions -->
                <div class="mt-6 pt-4 border-t border-gray-200">
                    <div class="grid grid-cols-3 gap-3">
                        <a href="catalog.html?featured=true" class="flex flex-col items-center p-3 rounded-lg hover:bg-yellow-50 group transition-colors">
                            <div class="w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center mb-2 group-hover:bg-yellow-200 transition-colors">
                                <i class="fas fa-star text-yellow-600 text-sm"></i>
                            </div>
                            <span class="text-xs text-center text-gray-600 group-hover:text-yellow-700">Featured Parts</span>
                        </a>
                        <a href="catalog.html?in_stock=true" class="flex flex-col items-center p-3 rounded-lg hover:bg-green-50 group transition-colors">
                            <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mb-2 group-hover:bg-green-200 transition-colors">
                                <i class="fas fa-check-circle text-green-600 text-sm"></i>
                            </div>
                            <span class="text-xs text-center text-gray-600 group-hover:text-green-700">In Stock</span>
                        </a>
                        <a href="catalog.html?sort=price_asc" class="flex flex-col items-center p-3 rounded-lg hover:bg-purple-50 group transition-colors">
                            <div class="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center mb-2 group-hover:bg-purple-200 transition-colors">
                                <i class="fas fa-tag text-purple-600 text-sm"></i>
                            </div>
                            <span class="text-xs text-center text-gray-600 group-hover:text-purple-700">Best Price</span>
                        </a>
                    </div>
                </div>
            `;
        }
        
        // Demo categories dropdown for navigation
        function getDemoCategoriesDropdownForNav() {
            // Return the same demo content as index.html
            return getDemoCategoriesDropdown();
        }
        
        // Demo categories dropdown function (same as index.html)
        function getDemoCategoriesDropdown() {
            // Same demo content as in index.html
            return `
                <div class="grid grid-cols-2 gap-6">
                    <div class="category-group">
                        <a href="?category=brake-system" 
                           class="main-category-link flex items-center space-x-3 p-3 rounded-lg hover:bg-red-50 group transition-all duration-200 mb-2 border-2 border-transparent hover:border-blue-200">
                            <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform duration-200 shadow-md">
                                <i class="fas fa-stop-circle text-white text-lg"></i>
                            </div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-gray-900 group-hover:text-red-600 transition-colors">Brake System</h4>
                                <p class="text-xs text-gray-500 mt-1">2 subcategories</p>
                            </div>
                            <i class="fas fa-arrow-right text-gray-400 group-hover:text-red-600 group-hover:translate-x-1 transition-all duration-200"></i>
                        </a>
                        <div class="subcategories ml-4 space-y-1">
                            <a href="?category=brake-pads" class="subcategory-link flex items-center space-x-2 py-2 px-3 rounded-md hover:bg-gray-50 group text-sm transition-colors duration-150">
                                <div class="w-2 h-2 bg-blue-400 rounded-full group-hover:bg-red-600 transition-colors"></div>
                                <span class="text-gray-600 group-hover:text-gray-900 transition-colors">Brake Pads</span>
                                <i class="fas fa-external-link-alt text-xs text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity ml-auto"></i>
                            </a>
                            <a href="?category=brake-discs" class="subcategory-link flex items-center space-x-2 py-2 px-3 rounded-md hover:bg-gray-50 group text-sm transition-colors duration-150">
                                <div class="w-2 h-2 bg-blue-400 rounded-full group-hover:bg-red-600 transition-colors"></div>
                                <span class="text-gray-600 group-hover:text-gray-900 transition-colors">Brake Discs</span>
                                <i class="fas fa-external-link-alt text-xs text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity ml-auto"></i>
                            </a>
                        </div>
                    </div>
                    
                    <div class="category-group">
                        <a href="?category=air-pressure" 
                           class="main-category-link flex items-center space-x-3 p-3 rounded-lg hover:bg-red-50 group transition-all duration-200 mb-2 border-2 border-transparent hover:border-blue-200">
                            <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform duration-200 shadow-md">
                                <i class="fas fa-wind text-white text-lg"></i>
                            </div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-gray-900 group-hover:text-red-600 transition-colors">Air Pressure</h4>
                                <p class="text-xs text-gray-500 mt-1">3 subcategories</p>
                            </div>
                            <i class="fas fa-arrow-right text-gray-400 group-hover:text-red-600 group-hover:translate-x-1 transition-all duration-200"></i>
                        </a>
                        <div class="subcategories ml-4 space-y-1">
                            <a href="?category=air-compressors" class="subcategory-link flex items-center space-x-2 py-2 px-3 rounded-md hover:bg-gray-50 group text-sm transition-colors duration-150">
                                <div class="w-2 h-2 bg-blue-400 rounded-full group-hover:bg-red-600 transition-colors"></div>
                                <span class="text-gray-600 group-hover:text-gray-900 transition-colors">Air Compressors</span>
                                <i class="fas fa-external-link-alt text-xs text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity ml-auto"></i>
                            </a>
                            <a href="?category=air-valves" class="subcategory-link flex items-center space-x-2 py-2 px-3 rounded-md hover:bg-gray-50 group text-sm transition-colors duration-150">
                                <div class="w-2 h-2 bg-blue-400 rounded-full group-hover:bg-red-600 transition-colors"></div>
                                <span class="text-gray-600 group-hover:text-gray-900 transition-colors">Air Valves</span>
                                <i class="fas fa-external-link-alt text-xs text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity ml-auto"></i>
                            </a>
                            <a href="?category=air-tanks" class="subcategory-link flex items-center space-x-2 py-2 px-3 rounded-md hover:bg-gray-50 group text-sm transition-colors duration-150">
                                <div class="w-2 h-2 bg-blue-400 rounded-full group-hover:bg-red-600 transition-colors"></div>
                                <span class="text-gray-600 group-hover:text-gray-900 transition-colors">Air Tanks</span>
                                <i class="fas fa-external-link-alt text-xs text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity ml-auto"></i>
                            </a>
                        </div>
                    </div>
                </div>
                
                <!-- Quick Actions -->
                <div class="mt-6 pt-4 border-t border-gray-200">
                    <div class="grid grid-cols-3 gap-3">
                        <a href="catalog.html?featured=true" class="flex flex-col items-center p-3 rounded-lg hover:bg-yellow-50 group transition-colors">
                            <div class="w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center mb-2 group-hover:bg-yellow-200 transition-colors">
                                <i class="fas fa-star text-yellow-600 text-sm"></i>
                            </div>
                            <span class="text-xs text-center text-gray-600 group-hover:text-yellow-700">Featured Parts</span>
                        </a>
                        <a href="catalog.html?in_stock=true" class="flex flex-col items-center p-3 rounded-lg hover:bg-green-50 group transition-colors">
                            <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mb-2 group-hover:bg-green-200 transition-colors">
                                <i class="fas fa-check-circle text-green-600 text-sm"></i>
                            </div>
                            <span class="text-xs text-center text-gray-600 group-hover:text-green-700">In Stock</span>
                        </a>
                        <a href="catalog.html?sort=price_asc" class="flex flex-col items-center p-3 rounded-lg hover:bg-purple-50 group transition-colors">
                            <div class="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center mb-2 group-hover:bg-purple-200 transition-colors">
                                <i class="fas fa-tag text-purple-600 text-sm"></i>
                            </div>
                            <span class="text-xs text-center text-gray-600 group-hover:text-purple-700">Best Price</span>
                        </a>
                    </div>
                </div>
            `;
        }
        
        // Mobile menu toggle
        document.getElementById('mobile-menu-button').addEventListener('click', function() {
            document.getElementById('mobile-menu').classList.toggle('hidden');
        });
    </script>
</body>
</html>