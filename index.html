<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inter Bus - Rare Bus Parts Supplier</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="css/custom-colors.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body class="bg-white min-h-screen" style="font-family: 'Inter', sans-serif;">
    <!-- Header -->
    <header class="bg-white sticky top-0 z-50 border-b border-slate-200">
        <div class="container mx-auto px-4 lg:px-8">
            <nav class="flex items-center justify-between h-16 lg:h-20">
                <!-- Left: Logo -->
                <div class="flex items-center">
                    <a href="index.html" class="flex items-center hover:opacity-80 transition-opacity">
                        <img src="LOGO1 1.svg" alt="Inter Bus" class="h-8 lg:h-10 w-auto">
                    </a>
                </div>

                <!-- Center: Navigation -->
                <div class="flex-1 flex justify-center">
                    <!-- Desktop Navigation -->
                    <div class="hidden lg:flex items-center space-x-8">
                        <a href="categories.html" class="text-gray-600 hover:text-red-600 font-medium transition-colors px-3 py-2 rounded-lg hover:bg-red-50">
                            <i class="fas fa-th-large mr-1"></i>
                            <span data-translate="categories">Categories</span>
                        </a>

                        <!-- Regular Navigation Links -->
                        <a href="catalog.html" class="text-gray-600 hover:text-red-600 font-medium transition-colors px-3 py-2 rounded-lg hover:bg-red-50" data-translate="catalog">Catalog</a>
                        <a href="about.html" class="text-gray-600 hover:text-red-600 font-medium transition-colors px-3 py-2 rounded-lg hover:bg-red-50" data-translate="about">About</a>
                        <a href="contact.html" class="text-gray-600 hover:text-red-600 font-medium transition-colors px-3 py-2 rounded-lg hover:bg-red-50" data-translate="contact">Contact</a>
                    </div>

                    <!-- Tablet Navigation -->
                    <div class="hidden md:flex lg:hidden items-center space-x-4">
                        <a href="catalog.html" class="text-gray-600 hover:text-red-600 font-medium transition-colors" data-translate="catalog">Catalog</a>
                        <a href="categories.html" class="text-gray-600 hover:text-red-600 font-medium transition-colors" data-translate="categories">
                            <i class="fas fa-th-large mr-1"></i>Categories
                        </a>
                    </div>
                </div>

                <!-- Right: User Actions -->
                <div class="flex items-center">
                    <!-- Right Side Navigation -->
                <div class="flex items-center space-x-2 lg:space-x-4">
                    <!-- Mobile menu button -->
                    <button id="mobile-menu-button" class="lg:hidden flex items-center px-3 py-2 rounded-lg text-gray-600 hover:text-red-600 hover:bg-red-50 transition-all duration-200">
                        <i class="fas fa-bars text-lg"></i>
                    </button>

                    <!-- Language Switcher -->
                    <div class="relative hidden sm:block">
                        <button onclick="toggleLanguageDropdown()" class="flex items-center space-x-1 text-gray-700 hover:text-red-600 py-2 px-2 lg:px-3 rounded-md transition-colors">
                            <span id="current-lang" class="text-sm font-medium">EN</span>
                            <i class="fas fa-chevron-down text-xs"></i>
                        </button>
                        <div id="language-dropdown" class="absolute top-full right-0 bg-white shadow-lg border rounded-lg hidden z-50 min-w-max">
                            <button onclick="setLanguage('en')" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 w-full text-left">üá¨üáß English</button>
                            <button onclick="setLanguage('ro')" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 w-full text-left">üá∑üá¥ Rom√¢nƒÉ</button>
                            <button onclick="setLanguage('ru')" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 w-full text-left">üá∑üá∫ –†—É—Å—Å–∫–∏–π</button>
                        </div>
                    </div>

                    <!-- Cart Icon -->
                    <div class="relative">
                        <a href="cart.html" class="flex items-center text-gray-600 hover:text-red-600 transition-colors p-2 rounded-lg hover:bg-red-50">
                            <i class="fas fa-shopping-cart text-lg"></i>
                            <span id="cart-counter" class="hidden absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-medium">0</span>
                        </a>
                    </div>

                    <!-- Auth Links -->
                    <div id="auth-links" class="hidden md:flex items-center space-x-3">
                        <a href="login.html" class="text-gray-600 hover:text-red-600 font-medium transition-colors" data-translate="login">Login</a>
                        <a href="register.html" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-all duration-200 font-medium shadow-sm hover:shadow-md" data-translate="register">Register</a>
                    </div>
                </div>
                </div>
            </nav>

            <!-- Mobile menu -->
            <div id="mobile-menu" class="lg:hidden hidden bg-white border-t shadow-lg max-h-screen overflow-y-auto">
                <div class="px-4 py-3 space-y-2">
                    <!-- Main Navigation -->
                    <div class="space-y-1">
                        <a href="catalog.html" class="block px-3 py-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors font-medium" data-translate="catalog">
                            <i class="fas fa-th-grid mr-2"></i>Catalog
                        </a>
                        <a href="about.html" class="block px-3 py-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors font-medium" data-translate="about">
                            <i class="fas fa-info-circle mr-2"></i>About
                        </a>
                        <a href="cart.html" class="flex items-center justify-between px-3 py-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors">
                            <span class="flex items-center">
                                <i class="fas fa-shopping-cart mr-2"></i><span data-translate="shopping_cart">Shopping Cart</span>
                            </span>
                            <span id="mobile-cart-counter" class="hidden bg-red-500 text-white text-xs rounded-full px-2 py-1 font-medium">0</span>
                        </a>
                        <a href="contact.html" class="block px-3 py-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors" data-translate="contact">
                            <i class="fas fa-envelope mr-2"></i>Contact
                        </a>
                    </div>

                    <!-- Categories Link -->
                    <div class="border-t pt-2">
                        <a href="categories.html" class="block px-3 py-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors font-medium">
                            <i class="fas fa-th-large mr-2"></i><span data-translate="categories">Categories</span>
                        </a>
                    </div>

                    <!-- Language Switcher -->
                    <div class="border-t pt-2">
                        <div class="flex justify-center space-x-4">
                            <button onclick="setLanguage('en')" class="px-2 py-1 text-sm text-gray-600 hover:text-red-600 transition-colors">üá¨üáß EN</button>
                            <button onclick="setLanguage('ro')" class="px-2 py-1 text-sm text-gray-600 hover:text-red-600 transition-colors">üá∑üá¥ RO</button>
                            <button onclick="setLanguage('ru')" class="px-2 py-1 text-sm text-gray-600 hover:text-red-600 transition-colors">üá∑üá∫ RU</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="relative bg-slate-900 overflow-hidden">
        <div class="absolute inset-0 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900"></div>
        <div class="absolute top-0 right-0 w-96 h-96 bg-red-600/10 rounded-full blur-3xl"></div>
        <div class="absolute bottom-0 left-0 w-64 h-64 bg-red-600/5 rounded-full blur-2xl"></div>
        <img src="bus.png" alt="Van Hool Bus" class="absolute bottom-12 right-12 w-72 object-cover opacity-20 hidden lg:block">
        <div class="relative container mx-auto px-4 pt-20 pb-16 lg:pt-28 lg:pb-24">
            <div class="max-w-5xl mx-auto">
                <div class="text-center mb-16">
                    <div class="inline-flex items-center px-4 py-2 bg-red-600/10 border border-red-500/20 rounded-full text-red-400 text-sm font-medium mb-8">
                        <i class="fas fa-truck mr-2"></i>
                        <span data-translate="trusted_worldwide">Trusted worldwide since 1999</span>
                    </div>
                    <h1 class="text-4xl lg:text-7xl font-bold mb-6 text-white leading-tight" data-translate="hero_title">
                        Premium Bus Parts
                    </h1>
                    <p class="text-xl lg:text-2xl mb-10 text-slate-400 max-w-3xl mx-auto leading-relaxed" data-translate="hero_subtitle">
                        Your trusted source for authentic bus parts and components. Quality parts, global shipping, expert support.
                    </p>
                    <div class="flex flex-col sm:flex-row gap-4 justify-center mb-16">
                        <a href="catalog.html" class="bg-red-600 text-white px-8 py-4 rounded-lg font-semibold text-lg hover:bg-red-700 transition-all shadow-lg shadow-red-600/25" data-translate="view_catalog">
                            Browse Catalog
                        </a>
                        <a href="contact.html" class="bg-white/10 text-white px-8 py-4 rounded-lg font-semibold text-lg border border-white/20 hover:bg-white/20 transition-all backdrop-blur-sm" data-translate="contact_us">
                            Get Quote
                        </a>
                    </div>
                </div>

                <!-- Stats -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div class="bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-8 text-center">
                        <div class="text-4xl font-bold text-white mb-2" id="parts-count">2000+</div>
                        <div class="text-slate-400 font-medium" data-translate="parts_available">Parts Available</div>
                    </div>
                    <div class="bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-8 text-center">
                        <div class="text-4xl font-bold text-white mb-2">50+</div>
                        <div class="text-slate-400 font-medium" data-translate="countries_served">Countries Served</div>
                    </div>
                    <div class="bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-8 text-center">
                        <div class="text-4xl font-bold text-white mb-2">25+</div>
                        <div class="text-slate-400 font-medium" data-translate="years_experience">Years Experience</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- About Us Section -->
    <section class="py-20 bg-white">
        <div class="container mx-auto px-4">
            <div class="max-w-4xl mx-auto text-center">
                <h2 class="text-3xl lg:text-4xl font-bold text-gray-900 mb-6" data-translate="about_inter_bus">
                    About Inter Bus
                </h2>
                <p class="text-lg text-gray-600 mb-8 leading-relaxed" data-translate="about_description">
                    Inter Bus is your trusted supplier of authentic bus parts and components worldwide. We specialize in providing hard-to-find, rare parts for all bus models, ensuring your fleet stays operational and safe. With over 25 years of experience in the industry, we maintain an extensive inventory of genuine parts and high-quality alternatives that meet or exceed OEM standards.
                </p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div class="text-center">
                        <div class="w-16 h-16 bg-red-50 rounded-xl flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-cogs text-red-600 text-2xl"></i>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-900 mb-2" data-translate="authentic_parts">Authentic Parts</h3>
                        <p class="text-gray-600 text-sm" data-translate="authentic_parts_desc">Genuine components from trusted manufacturers</p>
                    </div>
                    <div class="text-center">
                        <div class="w-16 h-16 bg-red-50 rounded-xl flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-shipping-fast text-red-600 text-2xl"></i>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-900 mb-2" data-translate="global_shipping">Global Shipping</h3>
                        <p class="text-gray-600 text-sm" data-translate="global_shipping_desc">Fast, reliable delivery to 50+ countries worldwide</p>
                    </div>
                    <div class="text-center">
                        <div class="w-16 h-16 bg-red-50 rounded-xl flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-users text-red-600 text-2xl"></i>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-900 mb-2" data-translate="expert_support">Expert Support</h3>
                        <p class="text-gray-600 text-sm" data-translate="expert_support_desc">Professional guidance from experienced specialists</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Featured Products Section -->
    <section class="py-16 bg-slate-50">
        <div class="container mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-900 mb-4" data-translate="latest_parts">
                    Latest Parts
                </h2>
                <p class="text-gray-600 max-w-2xl mx-auto" data-translate="latest_parts_desc">
                    Discover our bus parts collection. All parts come with detailed specifications and authentic part numbers.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" id="featured-products">
                <!-- Latest products will be loaded here -->
                <div class="text-center py-8 col-span-full">
                    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-red-600 mx-auto"></div>
                    <p class="mt-2 text-gray-500" data-translate="loading_products">Loading products...</p>
                </div>
            </div>

            <div class="text-center mt-12">
                <a href="catalog.html" class="bg-red-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-red-700 transition-colors" data-translate="see_all_parts">
                    See All Parts
                </a>
            </div>
        </div>
    </section>

    <!-- Universal App System -->
    <script src="js/app-universal.js"></script>
    <script type="module" src="js/config.js"></script>

    <script>
        console.log('üî• Index page loaded with universal system');


        // Load latest products with fallback logic
        async function loadLatestProducts() {
            try {
                const grid = document.getElementById('featured-products');

                console.log('üîç Loading latest products from Supabase...');

                // Wait for supabase to be available with retries
                let retries = 0;
                const maxRetries = 30;

                while ((!window.supabase && !window.CONFIG?.supabase) && retries < maxRetries) {
                    console.log(`‚è≥ Waiting for Supabase and CONFIG... (attempt ${retries + 1}/${maxRetries})`);
                    await new Promise(resolve => setTimeout(resolve, 200));
                    retries++;
                }

                // Use the available Supabase client
                const supabaseClient = window.CONFIG?.supabase || window.supabase;
                if (!supabaseClient) {
                    console.warn('‚ö†Ô∏è Supabase client not available after retries, using demo products');
                    grid.innerHTML = getDemoProducts();
                    return;
                }

                // Update global reference for compatibility
                if (!window.supabase && window.CONFIG?.supabase) {
                    window.supabase = window.CONFIG.supabase;
                }

                if (!window.DB_QUERIES) {
                    console.warn('‚ö†Ô∏è DB_QUERIES not available, using direct Supabase query');

                    // Try direct query for products
                    console.log('üîç Fetching products with direct query...');
                    const { data: products, error } = await window.supabase
                        .from('products')
                        .select('*')
                        .eq('is_active', true)
                        .order('created_at', { ascending: false })
                        .limit(10);

                    if (error) {
                        console.error('‚ùå Featured products query error:', error);
                        console.log('üì¶ Query failed, using demo products');
                        grid.innerHTML = getDemoProducts();
                        return;
                    }

                    if (products && products.length > 0) {
                        console.log(`‚úÖ Loaded ${products.length} products via direct query`);
                        grid.innerHTML = products.map(product => createProductCard(product)).join('');
                        return;
                    } else {
                        console.log('üì¶ No products found, checking database content...');

                        // Check if there are ANY products in the database
                        const { count, error: countError } = await window.supabase
                            .from('products')
                            .select('*', { count: 'exact', head: true });

                        console.log('üìä Total products in database:', count, 'Error:', countError?.message || 'none');
                    }

                    console.log('üì¶ No products found in database, using demo products');
                    grid.innerHTML = getDemoProducts();
                    return;
                }

                // Use standardized query for products
                console.log('üîÑ Using DB_QUERIES for products...');
                const productsQuery = window.DB_QUERIES.getProducts({
                    activeOnly: true,
                    inStockOnly: false,
                    limit: 10
                });

                if (!productsQuery) {
                    console.warn('‚ö†Ô∏è DB_QUERIES returned null, falling back to direct query');
                    throw new Error('DB_QUERIES returned null');
                }

                let { data: products, error } = await productsQuery;

                if (error) {
                    console.error('Supabase error:', error);
                    throw error;
                }

                if (products && products.length > 0) {
                    console.log(`‚úÖ Loaded ${products.length} products from database`);
                    grid.innerHTML = products.map(product => createProductCard(product)).join('');
                } else {
                    console.log('üì¶ No products found via DB_QUERIES, using demo products');
                    grid.innerHTML = getDemoProducts();
                }

            } catch (error) {
                console.error('‚ùå Error loading products:', error);
                console.error('Error details:', {
                    message: error.message,
                    code: error.code,
                    details: error.details,
                    hint: error.hint
                });

                // Try to test Supabase connection
                try {
                    console.log('üîç Testing Supabase connection...');
                    const { data, error: testError } = await window.supabase
                        .from('products')
                        .select('count', { count: 'exact', head: true });

                    if (testError) {
                        console.error('‚ùå Supabase connection test failed:', testError);
                    } else {
                        console.log('‚úÖ Supabase connection OK, total products count:', data);
                    }
                } catch (testErr) {
                    console.error('‚ùå Supabase connection test error:', testErr);
                }

                console.log('üì¶ Using demo products as fallback due to error');
                document.getElementById('featured-products').innerHTML = getDemoProducts();
            }
        }

        function createProductCard(product) {
            const currentLang = window.VanHoolApp?.currentLanguage || 'en';
            const translate = window.translate || ((key) => {
                const fallbackTranslations = {
                    'in_stock': 'In Stock',
                    'out_of_stock': 'Out of Stock',
                    'add_to_cart': 'Add to Cart'
                };
                return fallbackTranslations[key] || key;
            });

            return `
                <div class="bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow overflow-hidden border">
                    <a href="product.html?id=${product.id}">
                        <div class="aspect-w-1 aspect-h-1 bg-gray-100">
                            ${product.image_url ?
                                `<img src="${product.image_url}" alt="${product[`name_${currentLang}`] || product.name_en || product.name}" class="w-full h-48 object-cover">` :
                                `<div class="w-full h-48 bg-gray-200 flex items-center justify-center">
                                    <i class="fas fa-image text-gray-400 text-4xl"></i>
                                </div>`
                            }
                        </div>
                        <div class="p-4">
                            <div class="text-sm text-red-600 font-medium mb-1">${product.part_code || product.sku || 'N/A'}</div>
                            <h3 class="font-semibold text-gray-900 mb-2 line-clamp-2">
                                ${product[`name_${currentLang}`] || product.name_en || product.name || 'Product'}
                            </h3>
                            <div class="flex items-center justify-between">
                                <span class="text-lg font-bold text-gray-900">‚Ç¨${product.price}</span>
                                <span class="text-sm ${product.stock_quantity > 0 ? 'text-green-600' : 'text-red-600'}">
                                    ${product.stock_quantity > 0 ? translate('in_stock') : translate('out_of_stock')}
                                </span>
                            </div>
                        </div>
                    </a>
                    <div class="px-4 pb-4">
                        <button onclick="addToCart('${product.id}')"
                                class="w-full bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 transition-colors ${product.stock_quantity === 0 ? 'opacity-50 cursor-not-allowed' : ''}"
                                ${product.stock_quantity === 0 ? 'disabled' : ''}>
                            <i class="fas fa-cart-plus mr-2"></i>
                            ${translate('add_to_cart')}
                        </button>
                    </div>
                </div>
            `;
        }


        function getDemoProducts() {
            return `
                <div class="bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow overflow-hidden border">
                    <a href="product.html?id=1&code=VH-BP-F-AG300-001" class="block">
                        <div class="aspect-w-1 aspect-h-1 bg-gray-100">
                            <div class="w-full h-48 bg-gray-200 flex items-center justify-center">
                                <i class="fas fa-image text-gray-400 text-4xl"></i>
                            </div>
                        </div>
                        <div class="p-4">
                            <div class="text-sm text-red-600 font-medium mb-1">VH-BP-F-AG300-001</div>
                            <h3 class="font-semibold text-gray-900 mb-2 line-clamp-2">Front Brake Pads AG300</h3>
                            <div class="flex items-center justify-between mb-3">
                                <span class="text-lg font-bold text-gray-900">‚Ç¨125.99</span>
                                <span class="text-sm text-green-600">In Stock</span>
                            </div>
                        </div>
                    </a>
                    <div class="px-4 pb-4">
                        <button onclick="addToCart('1')" class="w-full bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 transition-colors">
                            <i class="fas fa-cart-plus mr-2"></i>Add to Cart
                        </button>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow overflow-hidden border">
                    <a href="product.html?id=2&code=VH-AS-R-A330-002" class="block">
                        <div class="aspect-w-1 aspect-h-1 bg-gray-100">
                            <div class="w-full h-48 bg-gray-200 flex items-center justify-center">
                                <i class="fas fa-image text-gray-400 text-4xl"></i>
                            </div>
                        </div>
                        <div class="p-4">
                            <div class="text-sm text-red-600 font-medium mb-1">VH-AS-R-A330-002</div>
                            <h3 class="font-semibold text-gray-900 mb-2 line-clamp-2">Rear Air Suspension A330</h3>
                            <div class="flex items-center justify-between mb-3">
                                <span class="text-lg font-bold text-gray-900">‚Ç¨890.50</span>
                                <span class="text-sm text-green-600">In Stock</span>
                            </div>
                        </div>
                    </a>
                    <div class="px-4 pb-4">
                        <button onclick="addToCart('2')" class="w-full bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 transition-colors">
                            <i class="fas fa-cart-plus mr-2"></i>Add to Cart
                        </button>
                    </div>
                </div>
            `;
        }

        // Mobile menu toggle
        document.getElementById('mobile-menu-button').addEventListener('click', function() {
            document.getElementById('mobile-menu').classList.toggle('hidden');
        });


        // Cart functionality
        window.addToCart = async function(productId, quantity = 1) {
            try {
                // Wait for cart manager to be available
                if (!window.cartManager) {
                    console.warn('Cart manager not available yet, waiting...');
                    await new Promise(resolve => {
                        const checkCartManager = () => {
                            if (window.cartManager) {
                                resolve();
                            } else {
                                setTimeout(checkCartManager, 100);
                            }
                        };
                        checkCartManager();
                    });
                }

                // Try to get product data from database first
                let productData = null;

                try {
                    if (window.DB_QUERIES) {
                        console.log('üîç Fetching product from database with ID:', productId);
                        const { data: product, error } = await window.DB_QUERIES.getProduct(productId);

                        if (error) {
                            console.warn('‚ö†Ô∏è Database query error:', error);
                            if (error.code !== 'PGRST116') { // Not found is OK, other errors log
                                console.error('Database error:', error);
                            }
                        }

                        if (!error && product) {
                            console.log('‚úÖ Product found in database:', product);
                            productData = product;
                        } else {
                            console.log('‚ùå Product not found in database, will try demo products');
                        }
                    } else {
                        console.warn('‚ö†Ô∏è DB_QUERIES not available, using demo products only');
                    }
                } catch (error) {
                    console.error('‚ùå Error fetching product from database:', error);
                }

                // Fallback to demo products if not found in database
                if (!productData) {
                    if (productId === '1') {
                        productData = {
                            id: productId,
                            name_en: 'Front Brake Pads AG300',
                            name: 'Front Brake Pads AG300',
                            part_code: 'VH-BP-F-AG300-001',
                            sku: 'VH-BP-F-AG300-001',
                            price: 125.99,
                            sale_price: null,
                            stock_quantity: 10,
                            is_active: true,
                            image_url: '/images/placeholder.svg',
                            images: ['/images/placeholder.svg'],
                            categories: { name: 'Brake System' },
                            brands: { name: 'Inter Bus' }
                        };
                    } else if (productId === '2') {
                        productData = {
                            id: productId,
                            name_en: 'Rear Air Suspension A330',
                            name: 'Rear Air Suspension A330',
                            part_code: 'VH-AS-R-A330-002',
                            sku: 'VH-AS-R-A330-002',
                            price: 890.50,
                            sale_price: null,
                            stock_quantity: 5,
                            is_active: true,
                            image_url: '/images/placeholder.svg',
                            images: ['/images/placeholder.svg'],
                            categories: { name: 'Air Pressure System' },
                            brands: { name: 'Inter Bus' }
                        };
                    }
                }

                if (!productData) {
                    console.error('‚ùå No product data available for ID:', productId);
                    showNotification('Produsul nu a fost gƒÉsit', 'error');
                    return;
                }

                console.log('üõí Adding product to cart:', {
                    id: productData.id,
                    name: productData.name_en || productData.name,
                    price: productData.price,
                    quantity: quantity
                });

                // Add to cart using the same approach as product.html
                const result = await window.cartManager.addItem(productData.id, quantity, {
                    productDetails: {
                        ...productData,
                        is_active: productData.is_active !== undefined ? productData.is_active : true,
                        stock_quantity: productData.stock_quantity || 10
                    },
                    name: productData.name_en || productData.name || productData.name_ro || 'Product',
                    sku: productData.part_code || productData.sku || 'N/A',
                    price: productData.sale_price || productData.price,
                    originalPrice: productData.price,
                    image: productData.image_url || (productData.images && productData.images[0]) || '/images/placeholder.svg',
                    category: productData.categories?.name || productData.category || '',
                    brand: productData.brands?.name || productData.brand || ''
                });

                console.log('üìä Cart addition result:', result);

                if (result.success) {
                    console.log('‚úÖ Product successfully added to cart');
                    showNotification(result.message || 'Produs adƒÉugat √Æn co»ô cu succes!', 'success');
                    updateCartCounter();
                } else {
                    console.error('‚ùå Failed to add product to cart:', result.error);
                    showNotification(result.error || 'Eroare la adƒÉugarea √Æn co»ô', 'error');
                }

            } catch (error) {
                console.error('üí• Error adding to cart:', error);
                showNotification('Eroare la adƒÉugarea √Æn co»ô', 'error');
            }
        };

        // Update cart counter in navigation
        function updateCartCounter() {
            if (window.cartManager) {
                const itemCount = window.cartManager.getItemCount();
                const counter = document.getElementById('cart-counter');
                const mobileCounter = document.getElementById('mobile-cart-counter');

                if (itemCount > 0) {
                    if (counter) {
                        counter.textContent = itemCount;
                        counter.classList.remove('hidden');
                    }
                    if (mobileCounter) {
                        mobileCounter.textContent = itemCount;
                        mobileCounter.classList.remove('hidden');
                    }
                } else {
                    if (counter) counter.classList.add('hidden');
                    if (mobileCounter) mobileCounter.classList.add('hidden');
                }
            }
        }

        // Show notification
        function showNotification(message, type = 'info') {
            // Remove existing notifications
            const existing = document.querySelectorAll('.cart-notification');
            existing.forEach(n => n.remove());

            const notification = document.createElement('div');
            notification.className = `cart-notification fixed top-4 right-4 p-4 rounded-md shadow-lg z-50 max-w-sm ${
                type === 'error' ? 'bg-red-100 border border-red-400 text-red-700' :
                type === 'success' ? 'bg-green-100 border border-green-400 text-green-700' :
                'bg-red-100 border border-red-400 text-red-700'
            }`;

            notification.innerHTML = `
                <div class="flex items-start">
                    <i class="fas ${
                        type === 'error' ? 'fa-exclamation-circle' :
                        type === 'success' ? 'fa-check-circle' :
                        'fa-info-circle'
                    } mt-0.5 mr-2 flex-shrink-0"></i>
                    <div class="flex-1">${message}</div>
                    <button type="button" class="ml-3 flex-shrink-0 hover:opacity-75" onclick="this.parentElement.parentElement.remove()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;

            document.body.appendChild(notification);

            // Auto remove after 4 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 4000);
        }

        // Language dropdown toggle
        function toggleLanguageDropdown() {
            const dropdown = document.getElementById('language-dropdown');
            dropdown.classList.toggle('hidden');
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('language-dropdown');
            const button = event.target.closest('button[onclick*="toggleLanguageDropdown"]');

            if (!button && !dropdown.contains(event.target)) {
                dropdown.classList.add('hidden');
            }
        });

        // Listen for cart changes to update counter
        document.addEventListener('DOMContentLoaded', function() {
            // Initial counter update
            setTimeout(updateCartCounter, 1000);

            // Listen for cart events if cart manager becomes available
            const checkForCartManager = () => {
                if (window.cartManager) {
                    window.cartManager.addListener((event) => {
                        if (['item_added', 'item_removed', 'item_updated', 'cart_cleared', 'cart_synced'].includes(event)) {
                            updateCartCounter();
                        }
                    });
                } else {
                    setTimeout(checkForCartManager, 500);
                }
            };
            checkForCartManager();

            // Listen for global cart count updates
            window.addEventListener('cartCountUpdated', function(event) {
                const count = event.detail.count;
                updateCartCounter();
            });
        });

        // Initialize page after universal system loads
        window.addEventListener('load', function() {
            console.log('üöÄ Page fully loaded, initializing...');
            loadLatestProducts();
            updateCartCounter(); // Update cart counter on page load
            console.log('‚úÖ Page initialization complete');
        });

        // Also try to load products when DOM is ready as backup
        document.addEventListener('DOMContentLoaded', function() {
            // Add a delay to ensure universal app is loaded
            setTimeout(() => {
                loadLatestProducts();
            }, 1000);
        });
    </script>

    <!-- Footer -->
    <footer class="bg-slate-900 text-white py-16">
        <div class="container mx-auto px-4 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <!-- Company Info -->
                <div class="md:col-span-1">
                    <div class="flex items-center mb-4">
                        <img src="LOGO1 1.svg" alt="Inter Bus" class="h-8 w-auto mr-3">
                        <span class="text-xl font-bold">Inter Bus</span>
                    </div>
                    <p class="text-slate-400 mb-4" data-translate="footer_description">
                        Your trusted partner for authentic bus parts and components worldwide.
                    </p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-slate-400 hover:text-white transition-colors"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="text-slate-400 hover:text-white transition-colors"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="text-slate-400 hover:text-white transition-colors"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>

                <!-- Quick Links -->
                <div>
                    <h4 class="font-semibold mb-4 text-slate-200" data-translate="quick_links">Quick Links</h4>
                    <ul class="space-y-2">
                        <li><a href="index.html" class="text-slate-400 hover:text-white transition-colors" data-translate="home">Home</a></li>
                        <li><a href="catalog.html" class="text-slate-400 hover:text-white transition-colors" data-translate="catalog">Catalog</a></li>
                        <li><a href="about.html" class="text-slate-400 hover:text-white transition-colors" data-translate="about">About</a></li>
                        <li><a href="contact.html" class="text-slate-400 hover:text-white transition-colors" data-translate="contact">Contact</a></li>
                    </ul>
                </div>

                <!-- Categories -->
                <div>
                    <h4 class="font-semibold mb-4 text-slate-200" data-translate="categories">Categories</h4>
                    <ul class="space-y-2">
                        <li><a href="catalog.html?category=brakes" class="text-slate-400 hover:text-white transition-colors" data-translate="footer_brakes">Brakes</a></li>
                        <li><a href="catalog.html?category=air-pressure" class="text-slate-400 hover:text-white transition-colors" data-translate="footer_air_pressure">Air Pressure</a></li>
                        <li><a href="catalog.html?category=engine-extension" class="text-slate-400 hover:text-white transition-colors" data-translate="footer_engine_extension">Engine & Extension</a></li>
                        <li><a href="catalog.html?category=chassis-suspension" class="text-slate-400 hover:text-white transition-colors" data-translate="footer_chassis_suspension">Chassis & Suspension</a></li>
                    </ul>
                </div>

                <!-- Contact -->
                <div>
                    <h4 class="font-semibold mb-4 text-slate-200" data-translate="contact">Contact</h4>
                    <ul class="space-y-3">
                        <li class="text-slate-400 flex items-center"><i class="fas fa-phone mr-3 text-red-500"></i>+373 123 456 789</li>
                        <li class="text-slate-400 flex items-center"><i class="fas fa-envelope mr-3 text-red-500"></i>contact@interbus.md</li>
                        <li class="text-slate-400 flex items-center"><i class="fas fa-map-marker-alt mr-3 text-red-500"></i><span data-translate="address">Chi»ôinƒÉu, Moldova</span></li>
                    </ul>
                </div>
            </div>

            <div class="border-t border-slate-800 pt-8 mt-12 text-center text-slate-500 text-sm">
                <p>&copy; 2025 Inter Bus. <span data-translate="all_rights_reserved">All rights reserved.</span></p>
            </div>
        </div>
    </footer>
</body>
</html>
